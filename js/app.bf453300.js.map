{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/icon/login.png","webpack:///./src/assets/images/Rectangle-register.png","webpack:///./src/assets/icon/ruby.png","webpack:///./src/components/Button.vue","webpack:///src/components/Button.vue","webpack:///./src/components/Button.vue?fd2c","webpack:///./src/components/Button.vue?b0c8","webpack:///./src/App.vue?a0ea","webpack:///./src/ruby/ruby.js","webpack:///./src/App.vue","webpack:///./src/components/HeaderNav.vue","webpack:///./src/loading.js","webpack:///src/components/HeaderNav.vue","webpack:///./src/components/HeaderNav.vue?6850","webpack:///./src/components/HeaderNav.vue?5221","webpack:///./src/components/Login.vue","webpack:///./src/utils.js","webpack:///src/components/Login.vue","webpack:///./src/components/Login.vue?3e12","webpack:///./src/components/Login.vue?7dff","webpack:///src/App.vue","webpack:///./src/App.vue?2eec","webpack:///./src/App.vue?e3be","webpack:///./src/rubyClient.js","webpack:///./src/router/index.js","webpack:///./src/main.js","webpack:///./src/ruby/utils/bn128.js","webpack:///./src/ruby/client_rubyeth.js","webpack:///./src/ruby/utils/service.js","webpack:///./src/components/HeaderNav.vue?fb34","webpack:///./src/ruby/prover/redeem.js","webpack:///./src/assets/images/Rectangle.png","webpack:///./src/components/Login.vue?b1b6","webpack:///./src/assets/images/user-icon.png","webpack:///./src/ruby/client_base.js","webpack:///./src/ruby/utils/elgamal.js","webpack:///./src/components/Button.vue?fbb6","webpack:///./src/ruby/prover/transfer.js","webpack:///./src/ruby/prover/algebra.js","webpack:///./src/assets/images/footer.png","webpack:///./src/ruby/utils/aes.js","webpack:///./src/ruby/utils/utils.js","webpack:///./src/ruby/client_rubyerc20.js","webpack:///./src/ruby/prover/innerproduct.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","installedCssChunks","jsonpScriptSrc","p","exports","module","l","e","promises","cssChunks","Promise","resolve","reject","href","fullhref","existingLinkTags","document","getElementsByTagName","tag","dataHref","getAttribute","rel","existingStyleTags","linkTag","createElement","type","onload","onerror","event","request","target","src","err","Error","code","parentNode","removeChild","head","appendChild","then","installedChunkData","promise","onScriptComplete","script","charset","timeout","nc","setAttribute","error","clearTimeout","chunk","errorType","realSrc","message","name","undefined","setTimeout","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","console","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_c","_self","_t","_v","staticRenderFns","component","ruby","ClientRubyETH","require","ClientRubyERC20","ref","attrs","staticClass","staticStyle","model","showDialog","callback","$$v","expression","class","side","style","bgColor","tab","on","gohome","directives","rawName","_l","list","li","label","link","_s","user","nativeOn","$event","connect","arguments","quit","_e","loading","loadingCount","startLoading","msg","Loading","service","lock","text","background","endLoading","close","showLoading","hideLoading","props","default","components","ElDropdown","ElDropdownItem","ElDropdownMenu","computed","methods","show","register","stopPropagation","account","domProps","composing","toRegist","login","generatorKey","ownKey","registerOwnKey","randomUint256","BN","crypto","randomBytes","generatorBase64Key","btoa","toString","downloadScret","anchor","encodeURIComponent","Date","now","display","body","click","RButton","ElCol","ElRow","prop","created","headerNav","rLogin","Vue","showLogin","hideLogin","params","chainId","chainName","rpcUrls","blockExplorerUrls","nativeCurrency","symbol","decimals","method","Client","rubyApp","web3Provider","contracts","rubyETHContract","rubyERC20Contract","erc20TokenContract","rubyClient","alice_address","bob_address","init","net","initWeb3","async","ethereum","enable","log","web3","currentProvider","Web3","providers","HttpProvider","initContract","addresses","ETH","Arbitrum","folders","rubyETHabi","$","getJSON","abi","eth","Contract","setProvider","initRubyEthClient","accounts","getAccounts","rubyEthLogin","secret","rubyEthRegister","keypair","rubyEthDeposit","mint","rubyEthWithdraw","redeem","rubyEthBalance","balance","readBalanceFromContract","rubyEthAddress","publicKeyEncoded","rubyEthTransfer","remoteAddress","transfer","mintERC20Token","send","from","gas","hash","receipt","balanceOf","initRubyERC20Client","rubyERC20Register","rubyERC20Deposit","rubyERC20Withdraw","rubyERC20Balance","rubyERC20Address","rubyERC20Transfer","address","val","decoys","split","filter","x","use","VueRouter","routes","path","router","AccountRouter","beforeEach","to","next","includes","$message","Vuex","Dialog","store","Store","state","rubyBalance","mateMaskBalance","rubyAddress","mutations","setUser","setType","setRubyAddress","setRubyBalance","setMateMaskBalance","actions","commit","getBalance","toFixed","dispatch","Message","initRubyClient","$ruby","config","productionTip","h","App","$mount","EC","FIELD_MODULUS","GROUP_MODULUS","bn128","curve","short","a","b","gRed","g","zero","mul","red","q","randomScalar","toRed","bytes","serialize","point","y","getX","getY","unserialize","serialization","validate","serializedToEncoded","serialized","encodedToSerialized","encoded","representation","temp","pointEqual","point1","point2","eq","ClientBase","aes","BigNumber","constructor","home","super","mintGasLimit","that","checkRegistered","checkValue","unit","encGuess","encrypt","available","aesKey","nativeValue","utils","toBN","transaction","publicKeySerialized","_state","update","pending","parseInt","lastRollOver","TransferProver","RedeemProver","Service","proveTransfer","CLn","CRn","C","D","epoch","sk","bTransfer","bDiff","index","statement","witness","generateProof","proveRedeem","sender","ABICoder","GeneratorParams","GeneratorVector","FieldVector","FieldVectorPolynomial","PolyCommitment","InnerProductProver","RedeemProof","BA","BS","tCommits","getVector","forEach","tHat","mu","s_sk","s_b","s_tau","ipProof","ipProver","proof","statementHash","encodeParameters","aL","reverse","map","aR","plus","redNeg","alpha","sL","Array","sR","rho","ys","redMul","z","zs","redPow","twos","twoTimesZs","times","lPoly","rPoly","hadamard","add","tPolyCoefficients","innerProduct","polyCommitment","getCommitments","evalCommit","evaluate","tauX","getR","redAdd","k_sk","k_b","k_tau","A_y","getG","A_b","A_t","getH","A_u","gEpoch","gs","getGs","hPrimes","getHs","invert","hExp","P","sum","u_x","primeBase","ipStatement","ipWitness","elgamal","soliditySha3","sleep","wait","options","gasLimit","round_base","round_len","blockMinedTime","roundUnitTime","_transfers","Set","events","TransferOccurred","has","transactionHash","delete","returnValues","party","publicKey","blockNumber","getBlock","block","number","timestamp","getTransaction","inputs","_jsonInterface","element","parameters","decodeParameters","input","ct","decrypt","privateKey","nonceUsed","updated","_getRound","counter","setAvailable","setPending","privateKeySerialized","publicKeyHash","encodeParameter","pubKey","hashedKey","registered","numerator","denominator","setRedeemFeeStrategy","setTransferFeeStrategy","setRoundBase","setRoundLen","rubyAgency","setRubyAgency","Math","floor","getBlockNumber","getTime","current","ceil","MAX_PLAIN","getGuess","guess","currentRound","encBalances","encBalance","encState","getAccountState","encAvailable","encPending","last_roll_over","registerGasLimit","createAccount","generateKey","keyPairFromSecret","isRegistered","syncAccountState","sign","_address","redeemGasLimit","_away","encNewBalance","subPlain","u","receiver","transferGasLimit","estimate","size","contract","swap","trim","decoy","anonymitySize","serializedReceiver","receiverRegistered","estimated","concat","random","serializedY","unserialized","some","ciphertexts","CL","CR","gasPrice","getGasPrice","maxFeeValue","init_guess","gB","start","accumulator","neg","plain","cL","cR","addPlain","Convolver","Polynomial","TransferProof","A","B","CLnG","CLnG_k","CRnG","CRnG_k","C_0G","C_0G_k","DG","DG_k","y_0G","y_0G_k","gG","gG_k","C_XG","C_XG_k","y_XG","y_XG_k","f","f_k","z_A","s_r","recursivePolynomials","accum","aTop","pop","bTop","left","redSub","right","coefficients","shln","N","bitLength","r_A","r_B","negate","toNumber","v","phi","chi","psi","omega","Q","_","k","P_i","Q_i","vPow","poly","w","CRnR","y_0R","y_XR","DR","gR","wPow","convolver","y_p","convolution","y_q","y_poly","k_r","A_D","A_X","P2","hs","mapInto","gsInnards","hsInnards","blinding","gExp","gsVector","hsVector","vector","begin","end","other","innards","elem","constant","reduce","cur","subtract","redInvm","extract","parity","flip","exponents","unity","fft","inverse","div","even","odd","omegas","exponent","base","getCoefficients","coefficient","fill","mine","theirs","PedersenCommitment","coefficientCommitments","commitment","product","coefficient_i","eqn","product_i","createHash","digest","iv","cipher","createCipheriv","Buffer","final","getAuthTag","ciphertext","authTag","decipher","createDecipheriv","setAuthTag","K","seed","seed_red","p_1_4","y_squared","fromRed","redIAdd","erc20Token","approveGasLimit","allowance","approve","InnerProductProof","L","R","as","bs","ls","rs","previousChallenge","nPrime","asLeft","asRight","bsLeft","bsRight","gLeft","gRight","hLeft","hRight","xInv","gPrime","hPrime","aPrime","bPrime","PPrime","basePrime","salt"],"mappings":"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","file":"js/app.bf453300.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded CSS chunks\n \tvar installedCssChunks = {\n \t\t\"app\": 0\n \t}\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({\"Home\":\"Home\"}[chunkId]||chunkId) + \".\" + {\"Home\":\"f2de88ab\",\"chunk-fbffeefc\":\"eb07a48e\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// mini-css-extract-plugin CSS loading\n \t\tvar cssChunks = {\"Home\":1,\"chunk-fbffeefc\":1};\n \t\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n \t\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n \t\t\tpromises.push(installedCssChunks[chunkId] = new Promise(function(resolve, reject) {\n \t\t\t\tvar href = \"css/\" + ({\"Home\":\"Home\"}[chunkId]||chunkId) + \".\" + {\"Home\":\"9e6f463a\",\"chunk-fbffeefc\":\"c5d6faff\"}[chunkId] + \".css\";\n \t\t\t\tvar fullhref = __webpack_require__.p + href;\n \t\t\t\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n \t\t\t\tfor(var i = 0; i < existingLinkTags.length; i++) {\n \t\t\t\t\tvar tag = existingLinkTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n \t\t\t\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return resolve();\n \t\t\t\t}\n \t\t\t\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n \t\t\t\tfor(var i = 0; i < existingStyleTags.length; i++) {\n \t\t\t\t\tvar tag = existingStyleTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\");\n \t\t\t\t\tif(dataHref === href || dataHref === fullhref) return resolve();\n \t\t\t\t}\n \t\t\t\tvar linkTag = document.createElement(\"link\");\n \t\t\t\tlinkTag.rel = \"stylesheet\";\n \t\t\t\tlinkTag.type = \"text/css\";\n \t\t\t\tlinkTag.onload = resolve;\n \t\t\t\tlinkTag.onerror = function(event) {\n \t\t\t\t\tvar request = event && event.target && event.target.src || fullhref;\n \t\t\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + request + \")\");\n \t\t\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n \t\t\t\t\terr.request = request;\n \t\t\t\t\tdelete installedCssChunks[chunkId]\n \t\t\t\t\tlinkTag.parentNode.removeChild(linkTag)\n \t\t\t\t\treject(err);\n \t\t\t\t};\n \t\t\t\tlinkTag.href = fullhref;\n\n \t\t\t\tvar head = document.getElementsByTagName(\"head\")[0];\n \t\t\t\thead.appendChild(linkTag);\n \t\t\t}).then(function() {\n \t\t\t\tinstalledCssChunks[chunkId] = 0;\n \t\t\t}));\n \t\t}\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAHXCAYAAACxuV3NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAgoSURBVHgB7d3NbVxVGIDhbxKzjOQlEgkZOkgJpgOoAOggVBCoIKGChAqSDqAESohICsiGHehyQxA45M9/LOa+zyN5xpZtaXavdM53z5kB4CAts98vc/NkLunaAHDAdg+XOT6eSxACgMO2n7lxfy5BCAAO39fLfPrVXJAQAGzC8mCZj/dzAUIAsA3rPsFHD+cChABgO07WJaK7c05CALApy/1lPrlznv8QAoDNufb4PCOlQgCwPfuZG/fO+sdCALBNd8/61LEQAGzW7vFZRkqFAGC7zjRSKgQA2/bBkVIhANi85d77loiEAGD71iWio8fv+qUQACTs7ixz662nlAoBQMdbR0qFACDlzYtshACgZT9z47WRUiEA6Pni9EipEAAk/TtSKgQATf88dSwEAF0ny3x2WwgA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADihAAgTggA4oQAIE4IAOKEACBOCADijpa5eTKz+2kAODB/zFW4tpvnP68h+HYASPpraWg3vz6YWX4YAHJ2p39Yl4nWJaLdyQAQcbT/z2bx0Zfry9MBIOO1EOzm6YuZ65+v374YABLeGB9dY/B0fftmAEh463MEu3n2ZN0x+H4A2Lx3PlC2m+ffrW8/DgCb9oEni6/fXZPwywCwWe8NwavN42smiQA27INnDb3aPL7+MgYmiQA26EyHzq0xeLk85BgKgA068+mju3n2yCQRwPac6xhqk0QA23OB+wheThLZPAbYinOH4NQxFE8HgIN3oRvKTk0SAXDgLnxV5atJIhfaABy6S91Z7EIbgMO3myuwzK1H6+vtuZzj9eMcD5dx/PcXwBkd7a8kBLAly+wF9Ur8vh+uwLKf/9VvT/4EpKJkG/jb5PwAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('button',[_vm._t(\"default\",function(){return [_vm._v(\"button\")]})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <button>\r\n    <slot>button</slot>\r\n  </button>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nbutton {\r\n  font-family: EXO;\r\n  cursor: pointer;\r\n  padding: 8px;\r\n  background: linear-gradient(to bottom, #530009, #230004);\r\n  color: white;\r\n  border: 0;\r\n  border-radius: 0;\r\n}\r\nbutton:hover {\r\n  background: linear-gradient(to bottom, #FF001D, #550009);\r\n}\r\n</style>","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Button.vue?vue&type=template&id=4cc6bfad&scoped=true&\"\nimport script from \"./Button.vue?vue&type=script&lang=js&\"\nexport * from \"./Button.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Button.vue?vue&type=style&index=0&id=4cc6bfad&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cc6bfad\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/_vue-loader@15.10.1@vue-loader/lib/loaders/stylePostLoader.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/_less-loader@6.2.0@less-loader/dist/cjs.js??ref--11-oneOf-1-3!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=2e1d905d&prod&lang=less&\"","'use strict';\r\n\r\nvar ruby = exports;\r\n\r\nruby.ClientRubyETH = require('./client_rubyeth.js');\r\nruby.ClientRubyERC20 = require('./client_rubyerc20.js');\r\n\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"app\",attrs:{\"id\":\"app\"}},[_c('header-nav',{ref:\"header\",staticClass:\"nav\",attrs:{\"bgColor\":\"black\"}}),_c('div',{ref:\"main\",staticClass:\"main\",staticStyle:{\"position\":\"absolute\",\"top\":\"106px\",\"bottom\":\"26px\",\"width\":\"100%\"}},[_c('router-view')],1),_c('div',{ref:\"footer\",staticStyle:{\"background\":\"black\",\"position\":\"fixed\",\"bottom\":\"0px\",\"left\":\"0px\",\"width\":\"100%\",\"height\":\"26px\"}},[_c('img',{staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"src\":require(\"./assets/images/footer.png\"),\"alt\":\"\"}})]),_c('r-login',{model:{value:(_vm.showDialog),callback:function ($$v) {_vm.showDialog=$$v},expression:\"showDialog\"}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{class:_vm.side?'header header-side':'header',style:({'background-color':_vm.bgColor,'padding-left':_vm.tab?'63px':'41px'})},[_c('img',{staticClass:\"header-img\",attrs:{\"src\":require(\"@/assets/icon/ruby.png\")},on:{\"click\":_vm.gohome}}),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.tab),expression:\"tab\"}],staticClass:\"header-nav-item\"},_vm._l((_vm.list),function(li){return _c('li',{key:li.label},[(li.link != undefined)?_c('a',{staticClass:\"label anchorotherweb\",attrs:{\"href\":li.link,\"target\":`${li.link == '#'?'':'_blank'}`}},[_vm._v(_vm._s(li.label))]):_c('span',{staticClass:\"label\",class:{'active': true}},[_vm._v(_vm._s(li.label))])])}),0),_c('el-dropdown',{staticClass:\"header-info\"},[_c('div',[_c('img',{staticClass:\"layer\",attrs:{\"src\":require(\"@/assets/images/user-icon.png\")}}),_c('span',[_vm._v(\" \"+_vm._s(_vm.user)+\" \")])]),_c('el-dropdown-menu',[_c('el-dropdown-item',{nativeOn:{\"click\":function($event){return _vm.connect.apply(null, arguments)}}},[_vm._v(\" Reconnect \")]),(_vm.user!='......')?_c('el-dropdown-item',{nativeOn:{\"click\":function($event){return _vm.quit.apply(null, arguments)}}},[_vm._v(\" Quit \")]):_vm._e()],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Loading } from 'element-ui';\r\n\r\nlet loadingCount = 0;\r\nlet loading;\r\n\r\nconst startLoading = (msg = 'loading……') => {\r\n  loading = Loading.service({\r\n    lock: true,\r\n    text: msg,\r\n    background: 'rgba(0, 0, 0, 0.7)'\r\n  });\r\n};\r\n\r\nconst endLoading = () => {\r\n  loading.close();\r\n};\r\n\r\nexport const showLoading = (msg) => {\r\n  if (loadingCount === 0) {\r\n    startLoading(msg);\r\n  }\r\n  loadingCount += 1;\r\n};\r\n\r\nexport const hideLoading = () => {\r\n  if (loadingCount <= 0) {\r\n    return;\r\n  }\r\n  loadingCount -= 1;\r\n  if (loadingCount === 0) {\r\n    endLoading();\r\n  }\r\n};","<template>\r\n  <div\r\n    :class=\"side?'header header-side':'header'\"\r\n    :style=\"{'background-color':bgColor,'padding-left':tab?'63px':'41px'}\"\r\n  >\r\n    <img\r\n      class=\"header-img\"\r\n      src=\"@/assets/icon/ruby.png\"\r\n      @click=\"gohome\"\r\n    >\r\n    <ul\r\n      class=\"header-nav-item\"\r\n      v-show=\"tab\"\r\n    >\r\n      <li v-for=\"li in list\" :key=\"li.label\">\r\n        <a class=\"label anchorotherweb\" v-if=\"li.link != undefined\" :href=\"li.link\"\r\n        :target=\"`${li.link == '#'?'':'_blank'}`\">{{li.label}}</a>\r\n        <span class=\"label\" v-else :class=\"{'active': true}\">{{li.label}}</span>\r\n      </li>\r\n    </ul>\r\n    <el-dropdown class=\"header-info\">\r\n      <div>\r\n        <img\r\n          src=\"@/assets/images/user-icon.png\"\r\n          class=\"layer\"\r\n        >\r\n        <span>\r\n          {{user}}\r\n        </span>\r\n      </div>\r\n      <el-dropdown-menu>\r\n        <el-dropdown-item  @click.native=\"connect\">\r\n          Reconnect\r\n        </el-dropdown-item>\r\n        <el-dropdown-item v-if=\"user!='......'\" @click.native=\"quit\">\r\n          Quit\r\n        </el-dropdown-item>\r\n      </el-dropdown-menu>\r\n    </el-dropdown>\r\n    <!-- <div class=\"header-language\">\r\n      En\r\n    </div> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex';\r\nimport { Dropdown, DropdownItem, DropdownMenu } from 'element-ui';\r\nimport { showLoading, hideLoading } from '../loading';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [\r\n        {\r\n          label: 'Swap'\r\n        },\r\n        // {\r\n        //   label: 'Bridge',\r\n        //   link: '#'\r\n        //   // link: 'https://docs.ruby.network/tutorial/testnet-configuration'\r\n        // },\r\n        {\r\n          label: 'Tutorial',\r\n          link: 'https://docs.ruby.xyz/tutorial/connect-your-wallet'\r\n          // link: 'https://docs.ruby.network/tutorial/testnet-configuration'\r\n        },\r\n        {\r\n          label: 'Q&A',\r\n          link: 'https://docs.ruby.xyz/faqs/faqs'\r\n          // link: 'https://docs.ruby.network/mainnet-faqs/testnet-faq'\r\n        },\r\n        {\r\n          label: 'Info',\r\n          link: 'https://docs.ruby.xyz'\r\n          // link: 'https://docs.ruby.network/'\r\n        }\r\n      ]\r\n    };\r\n  },\r\n  props: {\r\n    side: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bgColor: {\r\n      type: String\r\n    },\r\n    tab: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  components: {\r\n      ElDropdown: Dropdown,\r\n      ElDropdownItem: DropdownItem,\r\n      ElDropdownMenu: DropdownMenu,\r\n  },\r\n  computed: mapState({\r\n    // 箭头函数可使代码更简练\r\n    user: state => {\r\n        const userall = state.user\r\n        const pre = userall.substring(0, 5)\r\n        const behined = userall.substring(userall.length - 7)\r\n        return `${pre}......${behined}`\r\n    },\r\n    type: state => {\r\n        return state.type\r\n    }\r\n  }),\r\n  methods:{\r\n    quit() {\r\n      this.$store.commit('setUser', '')\r\n      console.log(this.$ruby)\r\n      if(this.$ruby.rubyClient) {\r\n        this.$ruby.rubyClient.account = undefined\r\n        this.$ruby.rubyClient.home = undefined\r\n      }\r\n      this.$router.replace('/')\r\n    },\r\n    connect() {\r\n      console.log('connect')\r\n      this.initRubyClient('ETH')\r\n    },\r\n      gohome() {\r\n          this.$router.push('/');\r\n          this.$hideLoading();\r\n      },\r\n      async swap(command){\r\n          if (!this.$ruby.rubyClient) {\r\n           try {\r\n               await this.initRubyClient();\r\n           } catch (error) {\r\n               this.$message('Connect wallet Error');\r\n               console.error(error);\r\n           }\r\n        }\r\n        if (this.$store.state.type === command) {\r\n            this.$message('You Are Already Here');\r\n            return;\r\n        }\r\n        this.$store.commit('setType', command);\r\n        switch(command) {\r\n            case 'BNB': {\r\n                showLoading('init RubyBNBClient...')\r\n                try {\r\n                    await this.$ruby.initRubyEthClient();\r\n                } catch (error) {\r\n                    this.$message(error.message)\r\n                    console.error(error)\r\n                }\r\n                hideLoading()\r\n                this.$router.push('/login')\r\n                break;\r\n            }\r\n            default: {\r\n                this.$message('Coming Soon!')\r\n            }\r\n        }\r\n      }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n* {\r\n  font-family: EXO;\r\n}\r\n.header {\r\n  height: 106px;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20px 75px 10px 63px;\r\n}\r\n.active {\r\n  position: relative;\r\n  padding-bottom: 13px;\r\n}\r\n.active:after {\r\n  text-align: center;\r\n  position: absolute;\r\n  bottom: 0px; left: 0;\r\n  content: '';\r\n  width: 100%;\r\n  height: 3px;\r\n  background: red;\r\n  border-radius: 2px;\r\n}\r\n.label {\r\n  position: relative;\r\n  padding-bottom: 13px;\r\n}\r\n.label:hover:after {\r\n  text-align: center;\r\n  position: absolute;\r\n  bottom: 0px; left: 0;\r\n  content: '';\r\n  width: 100%;\r\n  height: 3px;\r\n  background: red;\r\n  border-radius: 2px;\r\n}\r\n\r\n.header-side::before {\r\n  content: '';\r\n  display: block;\r\n  position: absolute;\r\n  width: 320px;\r\n  height: 100%;\r\n  top: 0;\r\n  left: 0;\r\n  // background-image: linear-gradient(to right, #1c1243, #23095a);\r\n\r\n}\r\n.header-img {\r\n  cursor: pointer;\r\n  width: 134px;\r\n  z-index: 2;\r\n}\r\n\r\n.header-nav-item {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 125px;\r\n  margin-top: -5px;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: normal;\r\n  letter-spacing: normal;\r\n  text-align: justify;\r\n  color: #ffffff;\r\n  li {\r\n    font-family: EXO;\r\n    margin: 0 65px 0 0;\r\n    cursor: pointer;\r\n  }\r\n  .el-dropdown-link {\r\n    font-size: 18px;\r\n    font-weight: 600;\r\n    color: #ffffff;\r\n    cursor: pointer;\r\n    color: #409EFF;\r\n  }\r\n  .el-icon-arrow-down {\r\n    font-size: 12px;\r\n  }\r\n}\r\n\r\n.header-info {\r\n  cursor: pointer;\r\n  position: absolute;\r\n  right: 100px;\r\n  width: 187px;\r\n  height: 38px;\r\n  padding: 1px;\r\n  border-radius: 21px;\r\n  border-style: solid;\r\n  border-width: 1px;\r\n  border-color: #FF001D;\r\n  // border-image-source: linear-gradient(to right, #e388e8 16%, #590ab7 150%);\r\n  // border-image-source: linear-gradient(to right, red 16%, red 150%);\r\n  // border-image-slice: 1;\r\n  // background-image: linear-gradient(to bottom, #1a1c29, #1a1c29),\r\n  //   linear-gradient(to right, #e388e8 16%, #590ab7 150%);\r\n  background: transparent;\r\n  background-origin: border-box;\r\n  background-clip: content-box, border-box;\r\n  font-family: EXO;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-stretch: normal;\r\n  font-style: normal;\r\n  line-height: 1;\r\n  letter-spacing: normal;\r\n  color: #ffffff;\r\n  div {\r\n    width: 100%; height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  img {\r\n    margin: 0 9px 0 14px;\r\n    width: 18px;\r\n  }\r\n}\r\n.header-language {\r\n  position: absolute;\r\n  right: 35px;\r\n  width: 42px;\r\n  height: 42px;\r\n  margin: 5px 0 13px 0;\r\n  line-height: 42px;\r\n  text-align: center;\r\n  color: #ffffff;\r\n  border-radius: 21px;\r\n  border-style: solid;\r\n  border-width: 1px;\r\n  border-image-source: linear-gradient(to right, #e388e8 16%, #590ab7 150%);\r\n  border-image-slice: 1;\r\n  background-image: linear-gradient(to bottom, #1a1c29, #1a1c29),\r\n    linear-gradient(to right, #e388e8 16%, #590ab7 150%);\r\n  background-origin: border-box;\r\n  background-clip: content-box, border-box;\r\n}\r\n.anchorotherweb {\r\n    text-decoration: none;\r\n    color: #fff;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./HeaderNav.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./HeaderNav.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HeaderNav.vue?vue&type=template&id=052d3816&scoped=true&\"\nimport script from \"./HeaderNav.vue?vue&type=script&lang=js&\"\nexport * from \"./HeaderNav.vue?vue&type=script&lang=js&\"\nimport style0 from \"./HeaderNav.vue?vue&type=style&index=0&id=052d3816&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"052d3816\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.show)?_c('div',{staticClass:\"dialog-box\",on:{\"click\":_vm.close}},[_c('div',{staticClass:\"dialog\",style:(`height: ${!_vm.register?370:450}px`),on:{\"click\":function($event){$event.stopPropagation();}}},[(!_vm.register)?_c('img',{staticClass:\"outline\",attrs:{\"src\":require(\"../assets/images/Rectangle.png\"),\"alt\":\"\"}}):_c('img',{staticClass:\"outline\",attrs:{\"src\":require(\"../assets/images/Rectangle-register.png\"),\"alt\":\"\"}}),_c('img',{staticClass:\"login\",attrs:{\"src\":require(\"../assets/icon/login.png\"),\"alt\":\"\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.register),expression:\"!register\"}],staticClass:\"login-form\"},[_c('div',{staticClass:\"label gray-font\"},[_vm._v(\"Ruby Secret Key\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.account),expression:\"account\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.account)},on:{\"input\":function($event){if($event.target.composing)return;_vm.account=$event.target.value}}})]),_c('el-row',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.register),expression:\"!register\"}],staticClass:\"footer\",attrs:{\"type\":\"flex\",\"justify\":\"space-between\",\"align\":\"middle\"}},[_c('el-col',{staticClass:\"tip\",attrs:{\"span\":18}},[_c('div',{staticClass:\"white-font\"},[_vm._v(\"Don't have an Account? \")]),_c('div',{staticClass:\"switch-text red-font\",on:{\"click\":_vm.toRegist}},[_c('span',[_vm._v(\"Register\")])])]),_c('r-button',{staticStyle:{\"padding-left\":\"15px\",\"padding-right\":\"15px\"},nativeOn:{\"click\":function($event){return _vm.login.apply(null, arguments)}}},[_vm._v(\"Login\")])],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.register),expression:\"register\"}],staticClass:\"register\"},[_c('div',{staticClass:\"tip gray-font\",staticStyle:{\"margin-top\":\"20px\"}},[_vm._v(\"Please use our key generator or use a key that is as random as your Meramask wallet private key as the Ruby account private key, and copy it on paper for safekeeping.\")]),_c('div',{staticClass:\"tip red-font\",staticStyle:{\"margin-top\":\"20px\"}},[_vm._v(\"Never share your private key with others.\")]),_c('div',{staticClass:\"tip red-font\",staticStyle:{\"margin-top\":\"20px\"}},[_vm._v(\"This private key is for the access of \"+_vm._s('RUBY-'+this.type)+\" account. It cannot be used to access any other Ruby account.\")]),_c('div',{staticClass:\"options\"},[_c('r-button',{staticStyle:{\"width\":\"100%\"},nativeOn:{\"click\":function($event){return _vm.generatorKey.apply(null, arguments)}}},[_vm._v(\"Private Key Generator\")]),_c('div',{staticClass:\"red-font center-text\",staticStyle:{\"font-size\":\"12px\",\"margin\":\"10px\"}},[_vm._v(\"OR\")]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.ownKey),expression:\"ownKey\"}],staticStyle:{\"width\":\"55%\",\"box-sizing\":\"border-box\",\"padding\":\"0 5px\"},attrs:{\"type\":\"text\",\"placeholder\":\"Pick Your Own Key\"},domProps:{\"value\":(_vm.ownKey)},on:{\"input\":function($event){if($event.target.composing)return;_vm.ownKey=$event.target.value}}}),_c('r-button',{staticStyle:{\"margin-left\":\"5%\",\"width\":\"40%\"},nativeOn:{\"click\":function($event){return _vm.registerOwnKey.apply(null, arguments)}}},[_vm._v(\"Register with It\")])],1)],1),_c('div',{staticClass:\"red-font switch-text\",on:{\"click\":function($event){_vm.register=false}}},[_c('span',{staticClass:\"red-font\"},[_vm._v(\"Back to Login\")])])])],1)]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import BN from 'bn.js'\r\n// const utils = {};\r\nimport  crypto from 'crypto';\r\n\r\nconst randomUint256 = () => {\r\n    return new BN(crypto.randomBytes(32), 16);\r\n};\r\n\r\nexport const generatorBase64Key = () => {\r\n    return btoa(randomUint256().toString())\r\n}\r\n\r\nexport const downloadScret = (text, type) => {\r\n    const anchor = document.createElement('a')\r\n    anchor.setAttribute('href', 'data:text/plain;charset=utf-8,'+encodeURIComponent(`This private key is for the access of RUBY-p${type} account.It cannot be used to access any other Ruby account.`+'\\n'+text))\r\n    anchor.setAttribute('download', `ruby_${type}_secret_key_${Date.now()}`)\r\n    anchor.style.display = 'none'\r\n    document.body.appendChild(anchor)\r\n    anchor.click()\r\n    document.body.removeChild(anchor)\r\n}\r\n\r\n\r\n","<template>\r\n  <div class=\"dialog-box\" v-if=\"show\" @click=\"close\">\r\n    <div class=\"dialog\" @click.stop :style=\"`height: ${!register?370:450}px`\">\r\n      <img v-if=\"!register\" class=\"outline\" src=\"../assets/images/Rectangle.png\" alt=\"\">\r\n      <img v-else class=\"outline\" src=\"../assets/images/Rectangle-register.png\" alt=\"\">\r\n      <img class=\"login\" src=\"../assets/icon/login.png\" alt=\"\">\r\n      <!-- Login -->\r\n      <div v-show=\"!register\" class=\"login-form\">\r\n        <div class=\"label gray-font\">Ruby Secret Key</div>\r\n        <input type=\"text\" v-model=\"account\">\r\n      </div>\r\n      <el-row v-show=\"!register\" class=\"footer\" type=\"flex\" justify=\"space-between\" align=\"middle\">\r\n        <el-col class=\"tip\" :span=\"18\">\r\n          <div class=\"white-font\">Don't have an Account? </div>\r\n          <div class=\"switch-text red-font\" @click=\"toRegist\">\r\n            <span>Register</span>\r\n          </div>\r\n        </el-col>\r\n        <r-button style=\"padding-left: 15px; padding-right: 15px;\" @click.native=\"login\">Login</r-button>\r\n      </el-row>\r\n      <!-- Register -->\r\n      <div v-show=\"register\" class=\"register\">\r\n        <div class=\"tip gray-font\" style=\"margin-top: 20px;\">Please use our key generator or use a key that is as random as your Meramask wallet private key as the Ruby account private key, and copy it on paper for safekeeping.</div>\r\n        <div class=\"tip red-font\" style=\"margin-top: 20px;\">Never share your private key with others.</div>\r\n        <div class=\"tip red-font\" style=\"margin-top: 20px;\">This private key is for the access of {{'RUBY-'+this.type}} account. It cannot be used to access any other Ruby account.</div>\r\n        <div class=\"options\">\r\n          <r-button style=\"width: 100%\" @click.native=\"generatorKey\">Private Key Generator</r-button>\r\n          <div class=\"red-font center-text\" style=\"font-size: 12px; margin: 10px\">OR</div>\r\n          <div>\r\n            <input style=\"width: 55%; box-sizing: border-box; padding: 0 5px;\" type=\"text\" v-model=\"ownKey\" placeholder=\"Pick Your Own Key\">\r\n            <r-button style=\"margin-left:5%; width: 40%\" @click.native=\"registerOwnKey\">Register with It</r-button>\r\n          </div>\r\n          \r\n        </div>\r\n        <div class=\"red-font switch-text\" @click=\"register=false\">\r\n          <span class=\"red-font\">Back to Login</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {Col, Row} from \"element-ui\"\r\nimport Button from \"@/components/Button.vue\"\r\nimport { generatorBase64Key, downloadScret } from '../utils'\r\nexport default {\r\n  components: {\r\n    RButton: Button,\r\n    ElCol: Col,\r\n    ElRow: Row,\r\n  },\r\n  model: {\r\n    prop: 'show',\r\n    event: 'switch'\r\n  },\r\n  props: {\r\n    show: Boolean\r\n  },\r\n  data() {\r\n    return {\r\n      register: false,\r\n      account: '',\r\n      ownKey: ''\r\n    }\r\n  },\r\n  created() {\r\n    console.log(this.type)\r\n  },\r\n  computed: {\r\n    type() {\r\n      return this.$store.state.type\r\n    }\r\n  },\r\n  methods: {\r\n      async registerOwnKey() {\r\n          if (this.ownKey.length < 16) {\r\n              this.$message('Account length must be greater than 16')\r\n              return\r\n          }\r\n          if (!this.$ruby.rubyClient) {\r\n             this.$message(\"Your Local Client Connection Failed.Please Refresh The Page\");\r\n             return\r\n          }\r\n          this.$showLoading('registering...')\r\n          try {\r\n              await this.$ruby.rubyEthRegister(this.ownKey)\r\n          } catch (error) {\r\n              this.$message(error);\r\n              this.$hideLoading()\r\n              return;\r\n          }\r\n          this.$hideLoading()\r\n          downloadScret(this.ownKey, this.type)\r\n          this.register = false\r\n      },\r\n      async generatorKey() {\r\n        const scret = generatorBase64Key()\r\n           this.$showLoading('registering...')\r\n           try {\r\n               await this.$ruby.rubyEthRegister(scret)\r\n           } catch (error) {\r\n                this.$message(error);\r\n                this.$hideLoading();\r\n                return;\r\n           }\r\n           this.$hideLoading()\r\n           downloadScret(scret, this.type)\r\n           this.register = false\r\n      },\r\n      async login() {\r\n          if (!this.account) {\r\n              this.$message('please input scret')\r\n              return \r\n          }\r\n          if (!this.$ruby.rubyClient) {\r\n             this.$message(\"Your Local Client Connection Failed.Please Refresh The Page\");\r\n             return; \r\n          }\r\n          this.$showLoading('logining in...')\r\n          try {\r\n            const res = await this.$ruby.rubyEthLogin(this.account);\r\n            if (res == 0) {\r\n                this.$message('Login Successful')\r\n                try {\r\n                    const rubyAddress = await this.$ruby.rubyEthAddress()\r\n                    this.$store.commit('setRubyAddress', rubyAddress)\r\n                } catch (error) {\r\n                    this.account = ''\r\n                    if (error) {\r\n                        this.$message(error);\r\n                        this.$hideLoading()\r\n                        return;\r\n                    }\r\n                    this.$message('Something Went Wrong.')\r\n                    console.error(error)\r\n                }\r\n                this.account = ''\r\n                this.$hideLoading()\r\n                this.$router.push('/tx')\r\n                this.$hideLogin()\r\n            } else if (res == -1) {\r\n                this.$message({type: 'error', message: 'login failed: this ruby account dose not exist'})\r\n                this.account = ''\r\n                this.$hideLoading()\r\n                return\r\n            }\r\n          } catch (error) {\r\n              this.$message(error);\r\n              this.$hideLoading()\r\n              this.account = ''\r\n              return;\r\n          }\r\n      },\r\n    close () {\r\n      this.$emit('switch', false)\r\n    },\r\n    toRegist() {\r\n      if (!this.$ruby.rubyClient) {\r\n         this.$message(\"Your Local Client Connection Failed.Please Refresh The Page\");\r\n         return\r\n      }\r\n      this.register = true\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.dialog-box{\r\n  font-family: EXO;\r\n  position: absolute;\r\n  top: 0; right: 0; left: 0; bottom: 0;\r\n  -webkit-backdrop-filter: blur(7px);\r\n  backdrop-filter: blur(7px);\r\n  .dialog {\r\n    border: 1px solid #FF001D;\r\n    border-right: 0;\r\n    border-bottom: 0;\r\n    position: absolute;\r\n    top: 50%; left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 370px; height: 370px;\r\n    background-color: rgba(0, 0, 0, 0.7);\r\n    background-image: url('../assets/images/stripe.png');\r\n    background-repeat: no-repeat;\r\n    background-position: right top;\r\n\r\n    padding: 30px;\r\n    .outline {\r\n      z-index: -1;\r\n      position: fixed;\r\n      left: 0px; top: -1px;\r\n      pointer-events: none;\r\n    }\r\n    .login-form {\r\n      margin-top: 110px;\r\n      .label {\r\n        font-size: 12px;\r\n        padding-bottom: 7px;\r\n      }\r\n    }\r\n    input {\r\n      box-sizing: border-box;\r\n      border: 1px solid #FF001D;\r\n      width: 100%;  height: 35px;\r\n      padding: 0 5px;\r\n      text-decoration: none;\r\n      background: transparent;\r\n      outline: none;\r\n      color: white;\r\n      font-weight: 400;\r\n      font-size: 14px;\r\n      line-height: 1.5em;\r\n    }\r\n  }\r\n}\r\n.register {\r\n  font-family: EXO;\r\n  .tip {\r\n    font-size: 10px;\r\n  }\r\n  .options {\r\n    margin: 20px 0;\r\n  }\r\n}\r\n.footer {\r\n  position: absolute;\r\n  bottom: 30px;\r\n  width: 309px;\r\n  .tip {\r\n    font-size: 12px;\r\n  }\r\n}\r\n.switch-text {\r\n  font-size: 10px;\r\n  cursor: pointer;\r\n  span:hover {\r\n    border-bottom: 1px solid #FF001D;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=c539f6f6&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=c539f6f6&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c539f6f6\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div id=\"app\" ref=\"app\">\r\n    <header-nav ref=\"header\" class=\"nav\" bgColor=\"black\"></header-nav>\r\n    <div ref=\"main\" class=\"main\" style=\"position: absolute; top: 106px; bottom: 26px; width: 100%;\">\r\n      <router-view/>\r\n    </div>\r\n    <div ref=\"footer\" style=\"background: black; position: fixed; bottom: 0px; left: 0px; width: 100%; height: 26px;\">\r\n      <img style=\"width: 100%; height: 100%;\" src=\"./assets/images/footer.png\" alt=\"\">\r\n    </div>\r\n    <r-login v-model=\"showDialog\"></r-login>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport { Loading } from 'element-ui';\r\nimport headerNav from './components/HeaderNav';\r\nimport Login from \"@/components/Login.vue\"\r\nexport default {\r\n  components: {\r\n    headerNav,\r\n    rLogin: Login\r\n  },\r\n  data() {\r\n    return {\r\n      showDialog: false,\r\n      loadingCount: 0,\r\n      loading: undefined\r\n    }\r\n  },\r\n  created() {\r\n    Vue.prototype.$showLoading = this.showLoading\r\n    Vue.prototype.$hideLoading = this.hideLoading\r\n    Vue.prototype.$showLogin = this.showLogin\r\n    Vue.prototype.$hideLogin = this.hideLogin\r\n    Vue.prototype.$switchNetwork = this.switchNetwork\r\n  },\r\n  methods: {\r\n    showLoading(msg) {\r\n      if (this.loadingCount === 0) {\r\n        this.loading = Loading.service({\r\n          target: this.$refs.main,\r\n          lock: true,\r\n          text: msg || 'loading……',\r\n          background: 'rgba(0, 0, 0, 0.7)'\r\n        });\r\n      }\r\n      this.loadingCount += 1;\r\n    },\r\n    hideLoading() {\r\n      if (this.loadingCount <= 0) {\r\n        return;\r\n      }\r\n      this.loadingCount -= 1;\r\n      if (this.loadingCount === 0) {\r\n        this.loading.close();\r\n      }\r\n    },\r\n    showLogin() {\r\n      this.showDialog = true\r\n    },\r\n    hideLogin() {\r\n      this.showDialog = false\r\n    },\r\n    async switchNetwork(net) {\r\n\r\n    let params\r\n    if(net == 'ETH') {\r\n      params = [{\r\n        chainId: \"0x1a4\",\r\n        chainName: \"Optimism Goerli\",\r\n        rpcUrls: [\r\n          'https://goerli.optimism.io',\r\n        ],\r\n        blockExplorerUrls: [\r\n          'https://goerli-optimism.etherscan.io'\r\n        ],\r\n        nativeCurrency: {\r\n          name: 'ETH',\r\n          symbol: 'ETH',\r\n          decimals: 18\r\n        }\r\n      }]\r\n    }\r\n    else if(net == 'Arbitrum') {\r\n      console.log('select Arbitrum')\r\n      params = [{\r\n        chainId: \"0x66eed\",\r\n        chainName: \"Arbitrum Goerli Testnet\",\r\n        rpcUrls: [\r\n          'https://goerli-rollup.arbitrum.io/rpc',\r\n        ],\r\n        blockExplorerUrls: [\r\n          'https://goerli.arbiscan.io/'\r\n        ],\r\n        nativeCurrency: {\r\n          name: 'ETH',\r\n          symbol: 'ETH',\r\n          decimals: 18\r\n        }\r\n      }]\r\n    }\r\n    else {\r\n      return false\r\n    }\r\n    return window.ethereum.request({\r\n      method: 'wallet_addEthereumChain',\r\n      params\r\n    })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@font-face {\r\n  font-family: \"EXO\";\r\n  src: url('./assets/font/Exo-VariableFont_wght.ttf');\r\n}\r\n.el-message__content{\r\n  font-family: EXO !important;\r\n}\r\n#app {\r\n  font-family: EXO;\r\n}\r\nbody,\r\nhtml,\r\ndiv,\r\nul,\r\nol,\r\nli,\r\na {\r\n  padding: 0;\r\n  margin: 0;\r\n  box-sizing: border-box;\r\n}\r\nul,\r\nol,\r\nli {\r\n  list-style: none;\r\n}\r\n.main {\r\n  overflow-y: auto;\r\n  background: linear-gradient(to top, #920011, #440008);\r\n}\r\n.card {\r\n  position: relative;\r\n  border-top: 1px solid #FF001D;\r\n  background: linear-gradient(180deg, #800210 0%, #000000 30%);\r\n  filter: drop-shadow(0px 4px 4px rgba(0, 0, 0, 0.25)) drop-shadow(0px 4px 4px rgba(0, 0, 0, 0.25));\r\n}\r\n.white-font {\r\n  color: white;\r\n}\r\n.center-text {\r\n  text-align: center;\r\n}\r\n.gray-font {\r\n  color: #8A8A8A;\r\n}\r\n.red-font {\r\n  color: #FF001D;\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2e1d905d&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=2e1d905d&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/_vue-loader@15.10.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import $ from 'jquery'\r\nimport Web3 from 'web3'\r\nconst Client = require(\"./ruby/ruby\");\r\n\r\nconst rubyApp = {\r\n  web3Provider: null,\r\n  contracts: {\r\n      rubyETHContract: null,\r\n      rubyERC20Contract: null,\r\n      erc20TokenContract: null\r\n  },\r\n    rubyClient: null,\r\n    alice_address: '0xfb8C80F8143E5baF936fc5c6E73bB07A0a247D10',\r\n    //alice_secret: '22fE54326C85b427E9AC771e3EBbDc23f41aCf5b',\r\n    bob_address: '0xfc71E218fFF23fa5Da59bA02684e9393e84ff523',\r\n    //bob_secret: '10Eb73f9c463fF3302760bF0eFD8bBD7Cc751124',\r\n\r\n  init: function(net) {\r\n    return rubyApp.initWeb3(net);\r\n  },\r\n\r\n  initWeb3: async function(net) {\r\n    // Modern dApp browsers\r\n    if (window.ethereum) {\r\n        rubyApp.web3Provider = window.ethereum;\r\n        try {\r\n            // Request account access\r\n            await window.ethereum.enable();\r\n        } catch (error) {\r\n            // User denied account access\r\n            console.error(\"User denied account access\");\r\n        }\r\n        console.log(\"using modern dApp browser\");\r\n    }\r\n    // Legacy dApp browsers\r\n    else if (window.web3) {\r\n        rubyApp.web3Provider = window.web3.currentProvider;\r\n        console.log(\"using legacy dApp browser\");\r\n    }\r\n    // If no injected web3 instance is detected, fall back to Ganache\r\n    else {\r\n        //rubyApp.web3Provider = new Web3.providers.HttpProvider('http://localhost:7545');\r\n        rubyApp.web3Provider = new Web3.providers.HttpProvider(\"https://ropsten.infura.io/v3/f0133270d95d492aa5d4bb8944b36bc6\");\r\n        console.log(\"using ropsten\");\r\n    }\r\n    rubyApp.web3 = new Web3(rubyApp.web3Provider);\r\n\r\n    return rubyApp.initContract(net);\r\n  },\r\n\r\n  initContract: async function(net) {\r\n    console.log('initContract', net)\r\n      const addresses = {\r\n        ETH: '0xa391554CE9Dd3E504CADa7BD369Bf9d8Af59646e',\r\n        // ETH: '0xB391C0327Ad4cA4bD001257A6B0A9ff43532f5ab', //test\r\n        Arbitrum: '0xb7c767237C6B7193f9d7bbFAE4743f3c181E3aD3'\r\n      }\r\n      const folders = {\r\n        ETH: 'contracts_op',\r\n        // ETH: 'contracts_local', //test\r\n        Arbitrum: 'contracts_arbi'\r\n      }\r\n      /* Bsc testnet contract address */\r\n      console.log('folder:', folders[net], addresses[net])\r\n      let rubyETHabi = (await $.getJSON(folders[net]+'/RubyETH.json')).abi;\r\n      rubyApp.contracts.rubyETHContract = new rubyApp.web3.eth.Contract(rubyETHabi, addresses[net]);\r\n      rubyApp.contracts.rubyETHContract.setProvider(rubyApp.web3Provider);\r\n\r\n    //   let rubyERC20abi = (await $.getJSON('contracts/RubyERC20.json')).abi;\r\n    //   rubyApp.contracts.rubyERC20Contract = new rubyApp.web3.eth.Contract(rubyERC20abi, '0x2B27cd5BF14fC2e138A2456B9b30A1aC51926839');\r\n    //   rubyApp.contracts.rubyERC20Contract.setProvider(rubyApp.web3Provider);\r\n\r\n    //   let erc20abi = (await $.getJSON('contracts/TestRubyToken.json')).abi;\r\n    //   rubyApp.contracts.erc20TokenContract = new rubyApp.web3.eth.Contract(erc20abi, '0xf4E4457b708A2d3EE05E89F62fF119515029e9e8');\r\n    //   rubyApp.contracts.erc20TokenContract.setProvider(rubyApp.web3Provider);\r\n   \r\n\r\n      return rubyApp\r\n  },\r\n\r\n   \r\n    initRubyEthClient: async function ()  {\r\n        let accounts = await rubyApp.web3.eth.getAccounts();\r\n        this.rubyClient = new Client.ClientRubyETH(\r\n            rubyApp.web3,\r\n            rubyApp.contracts.rubyETHContract,\r\n            accounts[0] \r\n        );\r\n        await this.rubyClient.init();\r\n\r\n        //if (accounts[0] == this.alice_address)\r\n            //this.secret = this.alice_secret;\r\n        //else if (accounts[0] == this.bob_address)\r\n            //this.secret = this.bob_secret;\r\n\r\n        // Use the address without '0x' as the secret\r\n        // this.secret = accounts[0].slice(2);\r\n        console.log(\"Initialization completed.\");\r\n        return accounts[0]\r\n    },\r\n    rubyEthLogin: async function (secret) {\r\n        this.secret = secret\r\n        return await this.rubyClient.login(secret)\r\n    },\r\n    rubyEthRegister: async function (secret) {\r\n        await this.rubyClient.register(secret);\r\n        console.log(\r\n            'keypair: ',\r\n            this.rubyClient.account.keypair\r\n        );\r\n    },\r\n\r\n    rubyEthDeposit: async function (value) {\r\n        await this.rubyClient.register(this.secret);\r\n        await this.rubyClient.mint(value);\r\n    },\r\n\r\n    rubyEthWithdraw: async function (value) {\r\n        await this.rubyClient.register(this.secret);\r\n        await this.rubyClient.redeem(value);\r\n    },\r\n\r\n    // get balance\r\n    rubyEthBalance: async function () {\r\n        // console.log('this.secret: ', this.secret);\r\n        // await this.rubyClient.register(this.secret);\r\n        let balance = await this.rubyClient.readBalanceFromContract();\r\n        return balance\r\n    },\r\n\r\n    rubyEthAddress: async function () {\r\n        return this.rubyClient.account.publicKeyEncoded()\r\n    },\r\n\r\n    rubyEthTransfer: async function (remoteAddress, value) {\r\n        await this.rubyClient.transfer(remoteAddress, value);\r\n    },\r\n    \r\n    \r\n\r\n\r\n    mintERC20Token: async function () {\r\n        let accounts = await rubyApp.web3.eth.getAccounts(); \r\n        await new Promise((resolve, reject) => {\r\n            rubyApp.contracts.erc20TokenContract.methods.mint(accounts[0], \"20000000000000000000000000\")\r\n                .send({from: accounts[0], gas: 4700000})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Mint submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on(\"receipt\", (receipt) => {\r\n                    rubyApp.contracts.erc20TokenContract.methods.balanceOf(accounts[0])\r\n                        .call()\r\n                        .then((result) => {\r\n                            console.log(\"ERC20 funds minted (balance = \" + result + \").\");\r\n                            resolve(receipt);\r\n                        });\r\n                })\r\n                .on(\"error\", (error) => {\r\n                    reject(error);\r\n                });\r\n        });\r\n    },\r\n    initRubyERC20Client: async function ()  {\r\n        let accounts = await rubyApp.web3.eth.getAccounts();\r\n        console.log('accounts: ', accounts);\r\n        this.rubyClient = new Client.ClientRubyERC20(\r\n            rubyApp.web3,\r\n            rubyApp.contracts.rubyERC20Contract,\r\n            accounts[0],\r\n            rubyApp.contracts.erc20TokenContract\r\n        );\r\n        await this.rubyClient.init();\r\n\r\n        //if (accounts[0] == this.alice_address)\r\n            //this.secret = this.alice_secret;\r\n        //else if (accounts[0] == this.bob_address)\r\n            //this.secret = this.bob_secret;\r\n\r\n        // Use the address without '0x' as the secret\r\n        this.secret = accounts[0].slice(2);\r\n        console.log(\"Initialization completed.\");\r\n    },\r\n\r\n    rubyERC20Register: async function () {\r\n        await this.rubyClient.register(this.secret);\r\n        console.log(\r\n            'keypair: ',\r\n            this.rubyClient.account.keypair\r\n        );\r\n    },\r\n\r\n    rubyERC20Deposit: async function () {\r\n        await this.rubyClient.register(this.secret);\r\n        await this.rubyClient.mint(10);\r\n    },\r\n\r\n    rubyERC20Withdraw: async function () {\r\n        await this.rubyClient.register(this.secret);\r\n        await this.rubyClient.redeem(5);\r\n    },\r\n\r\n    rubyERC20Balance: async function () {\r\n        console.log('this.secret: ', this.secret);\r\n        await this.rubyClient.register(this.secret);\r\n        // let balance = await this.rubyClient.readBalanceFromContract();\r\n    },\r\n\r\n    rubyERC20Address: async function () {\r\n        console.log('ruby address: ', this.rubyClient.account.publicKeyEncoded());\r\n    },\r\n\r\n    rubyERC20Transfer: async function () {\r\n        var address = $('#TransferRubyERC20Address').val();\r\n        var decoys = $('#TransferRubyERC20Decoys').val().split(',').filter(x => x!='');\r\n        await this.rubyClient.transfer(address, 5, decoys);\r\n    },\r\n\r\n\r\n\r\n};\r\n\r\nexport default rubyApp\r\n","import Vue from 'vue'\r\nimport VueRouter from 'vue-router'\r\n// import { hideLoading, showLoading } from '../loading'\r\nimport rubyApp from '../rubyClient';\r\n\r\nVue.use(VueRouter)\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    name: 'Home',\r\n    component: () => import(/* webpackChunkName: \"Home\" */ '../views/Home.vue')\r\n  },\r\n  {\r\n    path: '/tx',\r\n    component: () => import('../views/Transact.vue')\r\n  },\r\n  // {\r\n  //   path: '/login',\r\n  //   name: 'Login',\r\n  //   component: () => import(/* webpackChunkName: \"login\" */ '../views/Login.vue')\r\n  // },\r\n  // {\r\n  //   path: '/select',\r\n  //   name: 'Select',\r\n  //   component: () => import(/* webpackChunkName: \"select\" */ '../views/Select.vue')\r\n  // },\r\n  // {\r\n  //   path: '/process',\r\n  //   name: 'Process',\r\n  //   component: () => import(/* webpackChunkName: \"Process\" */ '../views/Process.vue')\r\n  // },\r\n\r\n]\r\n\r\nconst router = new VueRouter({\r\n  routes\r\n})\r\n\r\n// 校验客户端状态，\r\n// 调用client.login\r\n\r\nconst AccountRouter = ['/']\r\nrouter.beforeEach(async (to, from, next) => {\r\n    // 这里要把rubyApp所有的client 都要校验一遍， 确保所有都client都没有 就跳转到首页\r\n    if (!AccountRouter.includes(to.path) && !rubyApp.rubyClient) {\r\n        Vue.prototype.$message(\"Please Init Your Client By Click On The Card Below!\");\r\n        next('/');\r\n        return \r\n    }\r\n    next();\r\n})\r\n\r\nexport default router\r\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport Vuex from 'vuex'\r\nimport router from './router'\r\n// import { Message, Dialog, Loading, Dropdown, DropdownItem, DropdownMenu } from 'element-ui';\r\nimport { Message, Dialog, Loading} from 'element-ui';\r\nimport rubyApp from './rubyClient'\r\n// import { showLoading, hideLoading} from './loading'\r\n\r\n// import 'element-ui/lib/theme-chalk/index.css';\r\nimport \"./assets/theme/ruby/index.css\"\r\n\r\nVue.use(Vuex)\r\nVue.use(Dialog);\r\nVue.use(Loading);\r\n// Vue.use(Dropdown);\r\n// Vue.use(DropdownItem);\r\n// Vue.use(DropdownMenu);\r\n// Vue.use(MessageBox);\r\n\r\n// Vue.use(ElementUI)\r\nconst store =  new Vuex.Store({\r\n    state: {\r\n      user: '',\r\n      type: '',\r\n      rubyBalance: 0,\r\n      mateMaskBalance: 0,\r\n      rubyAddress: '',\r\n    },\r\n    mutations: {\r\n      setUser(state, user) {\r\n        state.user = user\r\n      },\r\n      setType(state, type) {\r\n        state.type = type\r\n      },\r\n      setRubyAddress(state, rubyAddress) {\r\n        state.rubyAddress = rubyAddress\r\n      },\r\n      setRubyBalance(state, rubyBalance) {\r\n          state.rubyBalance = rubyBalance\r\n      },\r\n      setMateMaskBalance(state, mateMaskBalance) {\r\n        state.mateMaskBalance = mateMaskBalance\r\n      },\r\n    },\r\n    actions: {\r\n        async getRubyBalance({ commit }) {\r\n            const rubyBalance = await rubyApp.rubyEthBalance()\r\n            commit('setRubyBalance', rubyBalance)\r\n        },\r\n        async getMateMaskBalance({ commit, state }) {\r\n            const mateMaskBalance = await rubyApp.web3.eth.getBalance(state.user)\r\n            commit('setMateMaskBalance', (mateMaskBalance / 1000000000000000000).toFixed(4))\r\n        },\r\n        async getBalance({ dispatch }) {\r\n            // showLoading('Get account information...')\r\n            try {\r\n                await dispatch('getRubyBalance')\r\n                await dispatch('getMateMaskBalance')\r\n            } catch (error) {\r\n                Message('Something Went Wrong.')\r\n                console.error(error)\r\n            }\r\n            // hideLoading()\r\n        }\r\n    }\r\n})\r\n\r\n\r\nconst initRubyClient = (net) => {\r\n    return rubyApp.init(net).then( async function() {\r\n        // showLoading('connect service...')\r\n        try {\r\n            let accounts = await rubyApp.web3.eth.getAccounts();\r\n            console.log(accounts)\r\n            const balance = await rubyApp.web3.eth.getBalance(accounts[0])\r\n            // console.log('stop3')\r\n            console.log('banlance', balance) \r\n            // console.log('stop4')\r\n            store.commit('setUser', accounts[0])\r\n            // console.log('stop5')\r\n        } catch (error) {\r\n          console.log(error)\r\n            Message('Click The Account Button to Reconnect Your Wallet or Refresh This Page.')\r\n        }\r\n        // hideLoading()\r\n    })\r\n}\r\ninitRubyClient('ETH');\r\n\r\nVue.prototype.$ruby = rubyApp;\r\nVue.prototype.initRubyClient = initRubyClient;\r\n\r\n// bnjs wendang；随机生成字符串\r\n// login yonghu xinxi \r\n// Vue.component(Message.name, Message);\r\nVue.prototype.$message = Message;\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\nstore,\r\nrouter,\r\nrender: h => h(App)\r\n}).$mount('#app')","const BN = require('bn.js');\r\nconst EC = require('elliptic');\r\nconst crypto = require('crypto');\r\n\r\nconst FIELD_MODULUS = new BN(\"30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47\", 16);\r\nconst GROUP_MODULUS = new BN(\"30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001\", 16);\r\n\r\nconst bn128 = {};\r\n\r\nbn128.curve = new EC.curve.short({\r\n    a: '0',\r\n    b: '3',\r\n    p: FIELD_MODULUS,\r\n    n: GROUP_MODULUS,\r\n    gRed: false,\r\n    g: ['77da99d806abd13c9f15ece5398525119d11e11e9836b2ee7d23f6159ad87d4', '1485efa927f2ad41bff567eec88f32fb0a0f706588b4e41a8d587d008b7f875'],\r\n});\r\n\r\nbn128.zero = bn128.curve.g.mul(0);\r\n\r\nbn128.p = BN.red(bn128.curve.p);\r\nbn128.q = BN.red(bn128.curve.n);\r\n\r\nbn128.randomScalar = () => {\r\n    return new BN(crypto.randomBytes(32), 16).toRed(bn128.q);\r\n};\r\n\r\nbn128.bytes = (i) => { // i is a BN (red)\r\n    return \"0x\" + i.toString(16, 64);\r\n};\r\n\r\nbn128.serialize = (point) => {\r\n    if (point.x == null && point.y == null)\r\n        return [\"0x0000000000000000000000000000000000000000000000000000000000000000\", \"0x0000000000000000000000000000000000000000000000000000000000000000\"];\r\n    return [bn128.bytes(point.getX()), bn128.bytes(point.getY())];\r\n};\r\n\r\nbn128.unserialize = (serialization) => {\r\n    if (serialization[0] == \"0x0000000000000000000000000000000000000000000000000000000000000000\" && serialization[1] == \"0x0000000000000000000000000000000000000000000000000000000000000000\")\r\n        return bn128.zero;\r\n    var point = bn128.curve.point(serialization[0].slice(2), serialization[1].slice(2)); \r\n    if (!bn128.curve.validate(point))\r\n        throw new Error(\"Invalid public key (not on curve).\");\r\n    return point;\r\n};\r\n\r\nbn128.serializedToEncoded = (serialized) => {\r\n    return serialized[0] + serialized[1].slice(2);\r\n};\r\n\r\nbn128.encodedToSerialized = (encoded) => {\r\n    var x = \"0x\" + encoded.slice(2, 66);\r\n    var y = \"0x\" + encoded.slice(66);\r\n    return [x, y];\r\n};\r\n\r\nbn128.representation = (point) => {\r\n    var temp = bn128.serialize(point);\r\n    return temp[0] + temp[1].slice(2); \r\n};\r\n\r\nbn128.pointEqual = (point1, point2) => {\r\n    return point1.eq(point2);\r\n};\r\n\r\n\r\nmodule.exports = bn128;\r\n","const ClientBase = require('./client_base.js');\r\nconst aes = require('./utils/aes.js');\r\nconst BN = require('bn.js');\r\nconst BigNumber = require('bignumber.js');\r\n\r\nclass ClientRubyETH extends ClientBase {\r\n    \r\n    constructor(web3, ruby, home) {\r\n        super(web3, ruby, home);\r\n    }\r\n\r\n    async mint (value, mintGasLimit) {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        that.checkValue();\r\n        var account = that.account;\r\n        console.log(\"Initiating mint: value of \" + value + \" units (\" + value * that.unit + \" wei)\");\r\n\r\n        let encGuess = '0x' + aes.encrypt(new BN(account.available()).toString(16), account.aesKey);\r\n\r\n        var nativeValue = that.web3.utils.toBN(new BigNumber(value * that.unit)).toString();\r\n        if (mintGasLimit === undefined)\r\n            mintGasLimit = 400000;\r\n        let transaction = that.ruby.methods.mint(account.publicKeySerialized(), value, encGuess)\r\n            .send({from: that.home, value: nativeValue, gas: mintGasLimit})\r\n            .on('transactionHash', (hash) => {\r\n                console.log(\"Mint submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n            })\r\n            .on('receipt', async (receipt) => {\r\n                account._state = await account.update();\r\n                account._state.pending += parseInt(value);\r\n                console.log(\"Mint of \" + value + \" was successful (uses gas: \" + receipt[\"gasUsed\"] + \")\");  \r\n                console.log(\"Account state: available = \", that.account.available(), \", pending = \", that.account.pending(), \", lastRollOver = \", that.account.lastRollOver());\r\n            })\r\n            .on('error', (error) => {\r\n                console.log(\"Mint failed: \" + error);\r\n            });\r\n        return transaction;\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = ClientRubyETH;\r\n","const TransferProver = require('../prover/transfer.js');\r\nconst RedeemProver = require('../prover/redeem.js');\r\n\r\nclass Service {\r\n    constructor() {\r\n        var transfer = new TransferProver();\r\n        var redeem = new RedeemProver();\r\n\r\n        this.proveTransfer = (CLn, CRn, C, D, y, epoch, sk, r, bTransfer, bDiff, index) => {\r\n            var statement = {};\r\n            statement['CLn'] = CLn;\r\n            statement['CRn'] = CRn;\r\n            statement['C'] = C;\r\n            statement['D'] = D;\r\n            statement['y'] = y;\r\n            statement['epoch'] = epoch;\r\n\r\n            var witness = {};\r\n            witness['sk'] = sk;\r\n            witness['r'] = r;\r\n            witness['bTransfer'] = bTransfer;\r\n            witness['bDiff'] = bDiff;\r\n            witness['index'] = index;\r\n\r\n            return transfer.generateProof(statement, witness).serialize();\r\n        }\r\n\r\n        this.proveRedeem = (CLn, CRn, y, epoch, sender, sk, bDiff) => {\r\n            var statement = {};\r\n            statement['CLn'] = CLn;\r\n            statement['CRn'] = CRn;\r\n            statement['y'] = y;\r\n            statement['epoch'] = epoch;\r\n            statement['sender'] = sender;\r\n\r\n            var witness = {};\r\n            witness['sk'] = sk;\r\n            witness['bDiff'] = bDiff;\r\n\r\n            return redeem.generateProof(statement, witness).serialize();\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Service;\r\n","export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/_less-loader@6.2.0@less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./HeaderNav.vue?vue&type=style&index=0&id=052d3816&prod&lang=less&scoped=true&\"","const ABICoder = require('web3-eth-abi');\r\nconst BN = require('bn.js');\r\n\r\nconst bn128 = require('../utils/bn128.js');\r\nconst utils = require('../utils/utils.js');\r\nconst { GeneratorParams, GeneratorVector, FieldVector, FieldVectorPolynomial, PolyCommitment } = require('./algebra.js');\r\nconst InnerProductProver = require('./innerproduct.js');\r\n\r\nclass RedeemProof {\r\n    constructor() {\r\n        this.serialize = () => { // please initialize this before calling this method...\r\n            var result = \"0x\";\r\n            result += bn128.representation(this.BA).slice(2);\r\n            result += bn128.representation(this.BS).slice(2);\r\n\r\n            this.tCommits.getVector().forEach((commit) => {\r\n                result += bn128.representation(commit).slice(2);\r\n            });\r\n            result += bn128.bytes(this.tHat).slice(2);\r\n            result += bn128.bytes(this.mu).slice(2);\r\n\r\n            result += bn128.bytes(this.c).slice(2);\r\n            result += bn128.bytes(this.s_sk).slice(2);\r\n            result += bn128.bytes(this.s_b).slice(2);\r\n            result += bn128.bytes(this.s_tau).slice(2);\r\n\r\n            result += this.ipProof.serialize().slice(2);\r\n\r\n            return result;\r\n        }\r\n    }\r\n}\r\n\r\nclass RedeemProver {\r\n    constructor() {\r\n        var params = new GeneratorParams(32);\r\n        var ipProver = new InnerProductProver();\r\n\r\n        this.generateProof = (statement, witness) => { // salt probably won't be used\r\n            var proof = new RedeemProof();\r\n\r\n            var statementHash = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'uint256',\r\n                'address',\r\n            ], [\r\n                statement['CLn'],\r\n                statement['CRn'],\r\n                statement['y'],\r\n                statement['epoch'],\r\n                statement['sender'],\r\n            ])); // useless to break this out up top. \"psychologically\" easier\r\n\r\n            statement['CLn'] = bn128.unserialize(statement['CLn']);\r\n            statement['CRn'] = bn128.unserialize(statement['CRn']);\r\n            statement['y'] = bn128.unserialize(statement['y']);\r\n            witness['bDiff'] = new BN(witness['bDiff']).toRed(bn128.q);\r\n\r\n            var aL = new FieldVector(witness['bDiff'].toString(2, 32).split(\"\").reverse().map((i) => new BN(i, 2).toRed(bn128.q)));\r\n            var aR = aL.plus(new BN(1).toRed(bn128.q).redNeg());\r\n            var alpha = bn128.randomScalar();\r\n            proof.BA = params.commit(alpha, aL, aR);\r\n            var sL = new FieldVector(Array.from({ length: 32 }).map(bn128.randomScalar));\r\n            var sR = new FieldVector(Array.from({ length: 32 }).map(bn128.randomScalar));\r\n            var rho = bn128.randomScalar(); // already reduced\r\n            proof.BS = params.commit(rho, sL, sR);\r\n\r\n            var y = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(statementHash),\r\n                bn128.serialize(proof.BA),\r\n                bn128.serialize(proof.BS),\r\n            ]));\r\n\r\n            var ys = [new BN(1).toRed(bn128.q)];\r\n            for (let i = 1; i < 32; i++) { // it would be nice to have a nifty functional way of doing this.\r\n                ys.push(ys[i - 1].redMul(y));\r\n            }\r\n            ys = new FieldVector(ys); // could avoid this line by starting ys as a fieldvector and using \"plus\". not going to bother.\r\n            var z = utils.hash(bn128.bytes(y));\r\n            var zs = [z.redPow(new BN(2))];\r\n            var twos = [new BN(1).toRed(bn128.q)];\r\n            for (let i = 1; i < 32; i++) {\r\n                twos.push(twos[i - 1].redMul(new BN(2).toRed(bn128.q)));\r\n            }\r\n            var twoTimesZs = new FieldVector(twos).times(zs[0]);\r\n            var lPoly = new FieldVectorPolynomial(aL.plus(z.redNeg()), sL);\r\n            var rPoly = new FieldVectorPolynomial(ys.hadamard(aR.plus(z)).add(twoTimesZs), sR.hadamard(ys));\r\n            var tPolyCoefficients = lPoly.innerProduct(rPoly); // just an array of BN Reds... should be length 3\r\n            var polyCommitment = new PolyCommitment(params, tPolyCoefficients);\r\n            proof.tCommits = new GeneratorVector(polyCommitment.getCommitments()); // just 2 of them\r\n\r\n            var x = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(z),\r\n                ...polyCommitment.getCommitments().map(bn128.serialize),\r\n            ]));\r\n\r\n            var evalCommit = polyCommitment.evaluate(x);\r\n            proof.tHat = evalCommit.getX();\r\n            var tauX = evalCommit.getR();\r\n            proof.mu = alpha.redAdd(rho.redMul(x));\r\n\r\n            var k_sk = bn128.randomScalar();\r\n            var k_b = bn128.randomScalar();\r\n            var k_tau = bn128.randomScalar();\r\n\r\n            var A_y = params.getG().mul(k_sk);\r\n            var A_b = params.getG().mul(k_b).add(statement['CRn'].mul(zs[0]).mul(k_sk));\r\n            var A_t = params.getG().mul(k_b.redNeg()).add(params.getH().mul(k_tau));\r\n            var A_u = utils.gEpoch(statement['epoch']).mul(k_sk);\r\n\r\n            proof.c = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(x),\r\n                bn128.serialize(A_y),\r\n                bn128.serialize(A_b),\r\n                bn128.serialize(A_t),\r\n                bn128.serialize(A_u),\r\n            ]));\r\n\r\n            proof.s_sk = k_sk.redAdd(proof.c.redMul(witness['sk']));\r\n            proof.s_b = k_b.redAdd(proof.c.redMul(witness['bDiff'].redMul(zs[0])));\r\n            proof.s_tau = k_tau.redAdd(proof.c.redMul(tauX));\r\n\r\n            var gs = params.getGs();\r\n            var hPrimes = params.getHs().hadamard(ys.invert());\r\n            var hExp = ys.times(z).add(twoTimesZs);\r\n            var P = proof.BA.add(proof.BS.mul(x)).add(gs.sum().mul(z.redNeg())).add(hPrimes.commit(hExp)); // rename of P\r\n            P = P.add(params.getH().mul(proof.mu.redNeg())); // Statement P of protocol 1. should this be included in the calculation of v...?\r\n\r\n            var o = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n            ], [\r\n                bn128.bytes(proof.c),\r\n            ]));\r\n\r\n            var u_x = params.getG().mul(o); // Begin Protocol 1. this is u^x in Protocol 1. use our g for their u, our o for their x.\r\n            P = P.add(u_x.mul(proof.tHat)); // corresponds to P' in protocol 1.\r\n            var primeBase = new GeneratorParams(u_x, gs, hPrimes);\r\n            var ipStatement = { 'primeBase': primeBase, 'P': P };\r\n            var ipWitness = { 'l': lPoly.evaluate(x), 'r': rPoly.evaluate(x) };\r\n            proof.ipProof = ipProver.generateProof(ipStatement, ipWitness, o);\r\n\r\n            return proof;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = RedeemProver;\r\n\r\n","module.exports = \"data:image/png;base64,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\"","export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/_less-loader@6.2.0@less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=c539f6f6&prod&lang=less&scoped=true&\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAXCAYAAAAGAx/kAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFcSURBVHgBzZTPTcMwFMa/BHorlY9I0MojlA3aDToCG8AGhQkQE0AnACYoG5QNsMSFGzlwQ2C+h53EgTiN1QufFCXP9vvF748NRGShlMVkaTF+5mPdW2yl2tZnMQgwXHN62jL7BLzPMxRFOJqjVcMzDzF0pNMLf7h34mwZH52jj+pwjqbN8eNZGWZfkCy2KXOR0CQEt4MmpNqh6QmyK/fObkpnB83v/Pjqt0ekappV+2LVbKRq+yyA2V41tyif0+kyCMM4+y/kf6rKkevmERvRzmjOut0kT9k1G/W2AbI41MCAyYVGmgzwwZy9Gr+b8GBK92rVuR+MF00fRsOP03qgG9CEaVXDJhfSaBsPWiBRwdlbZ+W5cSc8FSQRfL7Jd44dFDbmTqBQAvqhxq7QLrm2qUDSXKKDq3BiO0R+PFh684HJ1poJ29BI3pFXIddwzoQZfx/fI00E2EfxFcY3PeGaJDpuJ9EAAAAASUVORK5CYII=\"","const BN = require('bn.js');\r\nconst utils = require('./utils/utils.js');\r\nconst bn128 = require('./utils/bn128.js');\r\nconst elgamal = require('./utils/elgamal.js');\r\nconst aes = require('./utils/aes.js');\r\nconst Service = require('./utils/service.js'); \r\nconst ABICoder = require('web3-eth-abi');\r\nconst BigNumber = require('bignumber.js');\r\nconst { soliditySha3 } = require('web3-utils');\r\n\r\nvar sleep = (wait) => new Promise((resolve) => {\r\n    setTimeout(resolve, wait);\r\n});\r\n\r\n\r\nclass ClientBase {\r\n    /**\r\n    Constrct a client, with given web3 object, Ruby contract, and home account (Ethereum address). \r\n\r\n    @param web3 A web3 object.\r\n    @param ruby The Ruby contract address.\r\n    @param home The home account (Ethereum address).\r\n    */\r\n    constructor(web3, ruby, home) {\r\n        if (web3 === undefined)\r\n            throw \"1st arg should be an initialized Web3 object.\";\r\n        if (ruby === undefined)\r\n            throw \"2nd arg should be a deployed Ruby constrct object.\";\r\n        if (home === undefined)\r\n            throw \"3rd arg should be the address of an Ethereum account.\";\r\n\r\n        console.log(\"Ruby contract: \" + ruby.options.address);\r\n        console.log(\"Native account: \" + home);\r\n\r\n        this.web3 = web3;\r\n        this.ruby = ruby;\r\n        this.home = home;\r\n    }\r\n\r\n    /**\r\n    Need a separate initialization method by design because we want the async/await feature which can not be used for a constructor.\r\n    */\r\n    async init() {\r\n        // 'this' is special in Javascript compared to other languages, it does NOT refer to the Client object when inside some context. \r\n        // So better use an alias to fix our reference to the Client object.\r\n        // Reference: https://stackoverflow.com/questions/20279484/how-to-access-the-correct-this-inside-a-callback\r\n        var that = this;\r\n        that.service = new Service();\r\n\r\n        that.gasLimit = 5470000; // \r\n        // TODO: set transaction confirmation blocks for testing?\r\n        // Reference: https://github.com/ethereum/web3.js/issues/2666\r\n        // This option is only available in web3 1.3.0, but not in 1.2.1\r\n        // web3.transactionConfirmationBlocks = 1;\r\n        that.round_base = await that.ruby.methods.round_base().call();\r\n        that.round_len = await that.ruby.methods.round_len().call();\r\n\r\n        // 3100 is the estimated milliseconds of mining a block. Determined empirically. IBFT, block time.\r\n        that.blockMinedTime = 3100;\r\n        if (that.round_base == 0)\r\n            that.roundUnitTime = that.blockMinedTime; \r\n        else if (that.round_base == 1)\r\n            that.roundUnitTime = 1000; // 1 second\r\n        else\r\n            throw new Error(\"Invalid round base.\");\r\n        // The amount of tokens represented by one unit.\r\n        // Most of the time, one token is too small and it is not worthwhile to use private \r\n        // transaction for such small amount. Hence in Ruby, we contrain all private operations \r\n        // to take place in terms of unit that can represent a large amount of tokens. For example,\r\n        // a reasonable choice of 1 unit could be 1e16 wei (0.01 ETH).\r\n        that.unit = await that.ruby.methods.unit().call();\r\n\r\n        this._transfers = new Set();\r\n\r\n        /**\r\n        Register the TransferOccurred event for this client.\r\n        Since a transfer is triggered by a sender, it is necessary to register this event to notify a transfer \"receiver\" to keep track of local account state (without manually synchronizing with contract).\r\n        */\r\n        this.ruby.events.TransferOccurred({})\r\n            .on('data', (event) => {\r\n                console.log(\"Receive TransferOccurred event\");\r\n                if (that._transfers.has(event.transactionHash)) {\r\n                    // This is the sender of the transfer operation, hence we will simply return.\r\n                    that._transfers.delete(event.transactionHash);\r\n                    return;\r\n                }\r\n                var account = that.account;\r\n                event.returnValues['parties'].forEach((party, i) => {\r\n                    if (bn128.pointEqual(account.publicKey(), party)) {\r\n                        var blockNumber = event.blockNumber;\r\n                        this.web3.eth.getBlock(blockNumber).then(async (block) => {\r\n                            if (that.round_base == 0)\r\n                                account._state = await account.update(block.number);\r\n                            else if (that.round_base == 1)\r\n                                account._state = await account.update(block.timestamp);\r\n                            else\r\n                                throw new Error(\"Invalid round base.\");\r\n\r\n                            this.web3.eth.getTransaction(event.transactionHash).then((transaction) => {\r\n                                var inputs;\r\n                                that.ruby._jsonInterface.forEach((element) => {\r\n                                    if (element['name'] == \"transfer\")\r\n                                        inputs = element['inputs'];\r\n                                });\r\n                                // slice(10) because the first 10 bytes are used for the Method ID (function selector): 0x********\r\n                                // NOTE: in binary mode, this is just 4 bytes, but since the transaction stores the input as readable\r\n                                // ascii string, hence '0x' and 8 base-16 chars (representing 4 bytse) will constitute 10 bytes.\r\n                                // ABI encoding: https://solidity.readthedocs.io/en/latest/abi-spec.html#argument-encoding\r\n                                var parameters = this.web3.eth.abi.decodeParameters(inputs, \"0x\" + transaction.input.slice(10));\r\n                                var ct = elgamal.unserialize([parameters['C'][i], parameters['D']]);\r\n                                var value = elgamal.decrypt(ct, account.privateKey());\r\n                                if (value > 0) {\r\n                                    account._state.pending += value;\r\n                                    console.log(\"Transfer of \" + value + \" received! Balance now \" + account.balance() + \".\");\r\n                                }\r\n                            });\r\n                        });\r\n                    }\r\n                });\r\n            })\r\n            .on('error', (error) => {\r\n                console.log(error); \r\n            });\r\n\r\n\r\n        /**\r\n        Ruby account, containing various information such as the public/private key pair, balance, etc.\r\n        */\r\n        this.account = new function() {\r\n            this.keypair = undefined;\r\n            this.aesKey = undefined;\r\n            this._state = {\r\n                available: 0,\r\n                pending: 0,\r\n                nonceUsed: 0,\r\n                lastRollOver: 0\r\n            };\r\n\r\n            this.update = async (counter) => {\r\n                var updated = {};\r\n                updated.available = this._state.available;\r\n                updated.pending = this._state.pending;\r\n                updated.nonceUsed = this._state.nonceUsed;\r\n                updated.lastRollOver = await that._getRound(counter);\r\n                if (this._state.lastRollOver < updated.lastRollOver) {\r\n                    updated.available += updated.pending;\r\n                    updated.pending = 0;\r\n                    updated.nonceUsed = false;\r\n                }\r\n                return updated;\r\n            };\r\n\r\n            this.available = () => {\r\n                return this._state.available;\r\n            };\r\n\r\n            this.setAvailable = (value) => {\r\n                this._state.available = value;\r\n            };\r\n\r\n            this.pending = () => {\r\n                return this._state.pending;\r\n            };\r\n\r\n            this.setPending = (value) => {\r\n                this._state.pending = value;\r\n            };\r\n\r\n            this.lastRollOver = () => {\r\n                return this._state.lastRollOver;\r\n            };\r\n\r\n            this.balance = () => {\r\n                return this._state.available + this._state.pending;\r\n            };\r\n\r\n            this.publicKey = () => {\r\n                return this.keypair['y'];\r\n            };\r\n\r\n            this.privateKey = () => {\r\n                return this.keypair['x'];\r\n            };\r\n\r\n            this.publicKeySerialized = () => {\r\n                return bn128.serialize(this.keypair['y']);\r\n            };\r\n\r\n            this.privateKeySerialized = () => {\r\n                return bn128.bytes(this.keypair['x']);\r\n            };\r\n\r\n            this.publicKeyEncoded = () => {\r\n                return bn128.serializedToEncoded(this.publicKeySerialized());\r\n            };\r\n\r\n            this.publicKeyHash = () => {\r\n                var encoded = ABICoder.encodeParameter(\"bytes32[2]\", this.publicKeySerialized());\r\n                return soliditySha3(encoded); \r\n            };\r\n\r\n        };\r\n        // First update to initialize the state.\r\n        this.account._state = await this.account.update();\r\n\r\n    }\r\n\r\n    static async registered (ruby, pubKey) {\r\n        var encoded = ABICoder.encodeParameter(\"bytes32[2]\", pubKey);\r\n        var hashedKey = soliditySha3(encoded);\r\n        return await ruby.methods.registered(hashedKey).call();\r\n    }\r\n\r\n    async setRedeemFeeStrategy (numerator, denominator) {\r\n        var that = this;\r\n        let transaction = that.ruby.methods.setRedeemFeeStrategy(numerator, denominator)\r\n                .send({from: that.home, gas: that.gasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Change redeem fee submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Change redeem fee successful.\");\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Change redeem fee failed: \" + error);\r\n                    throw error;\r\n                });\r\n        return transaction;\r\n    }\r\n\r\n    async setTransferFeeStrategy (numerator, denominator) {\r\n        var that = this;\r\n        let transaction = that.ruby.methods.setTransferFeeStrategy(numerator, denominator)\r\n                .send({from: that.home, gas: that.gasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Change transfer fee submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Change transfer fee successful.\");\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Change transfer fee failed: \" + error);\r\n                    throw error;\r\n                });\r\n        return transaction;\r\n    }\r\n\r\n    async setRoundBase (round_base) {\r\n        var that = this;\r\n        let transaction = that.ruby.methods.setRoundBase(round_base)\r\n                .send({from: that.home, gas: that.gasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Set round base submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Set round base successful.\");\r\n                    that.round_base = round_base;\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Set epohc base failed: \" + error);\r\n                    throw error;\r\n                });\r\n        return transaction;\r\n    }\r\n\r\n    async setRoundLen (round_len) {\r\n        var that = this;\r\n        let transaction = that.ruby.methods.setRoundLen(round_len)\r\n                .send({from: that.home, gas: that.gasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Set round length submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Set round length successful.\");\r\n                    that.round_len = round_len;\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Set epohc length failed: \" + error);\r\n                    throw error;\r\n                });\r\n        return transaction;\r\n    }\r\n\r\n    async setRubyAgency (rubyAgency) {\r\n        var that = this;\r\n        let transaction = that.ruby.methods.setRubyAgency(rubyAgency)\r\n                .send({from: that.home, gas: that.gasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Set ruby agency submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Set ruby agency successful.\");\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Set ruby agency failed: \" + error);\r\n                    throw error;\r\n                });\r\n        return transaction;\r\n    }\r\n\r\n\r\n    /**\r\n    Get the round corresponding to the given timestamp (if not given, use current time).\r\n    This round is based on time, and does not start from 0, because it simply divides the timestamp by round length.\r\n\r\n    TODO: should change to block based.\r\n\r\n    @param timestamp The given timestamp. Use current time if it is not given.\r\n\r\n    @return The round corresponding to the timestamp (current time if not given).\r\n    */\r\n    async _getRound (counter) {\r\n        var that = this;\r\n        if (that.round_base == 0) {\r\n            if (counter === undefined)\r\n                return Math.floor((await that.web3.eth.getBlockNumber()) / that.round_len);\r\n            else\r\n                return counter / that.round_len; \r\n        }\r\n        else if (that.round_base == 1)\r\n            return Math.floor((counter === undefined ? (new Date).getTime() / 1000 : counter) / that.round_len);\r\n        else\r\n            throw new Error(\"Invalid round base.\");\r\n    }\r\n\r\n    /**\r\n    Get seconds away from next round change.\r\n\r\n    TODO: should change to block based.\r\n    */\r\n    async _away () {\r\n        var that = this;\r\n        if (that.round_base == 0) {\r\n            let current = await that.web3.eth.getBlockNumber();\r\n            return Math.ceil(current / that.round_len) * that.round_len - current;\r\n        }\r\n        else if (that.round_base == 1) {\r\n            let current = (new Date).getTime();\r\n            return (Math.ceil(current / (that.round_len * 1000)) * (that.round_len * 1000) - current) / 1000;\r\n        }\r\n    }\r\n\r\n    checkRegistered () {\r\n        var that = this;\r\n        if (that.account.keypair === undefined)\r\n            throw \"Call register() first to register an account.\";\r\n    }\r\n\r\n    checkValue (value) {\r\n        if (value <= 0 || value > elgamal.MAX_PLAIN)\r\n            throw \"Invalid value: \" + value;\r\n    }\r\n\r\n    async getGuess () {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        let encGuess = await that.ruby.methods.getGuess(that.account.publicKeySerialized()).call();\r\n        if (encGuess == null)\r\n            return 0;\r\n        var guess = aes.decrypt(encGuess.slice(2), that.account.aesKey);\r\n        guess = parseInt(guess, 16);\r\n        console.log(\"guess: \", guess);\r\n        return guess;\r\n    }\r\n\r\n    /**\r\n    Read account balance from Ruby contract.\r\n    \r\n    @return A promise that is resolved with the balance.\r\n    */\r\n    async readBalanceFromContract () {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        let currentRound = await that._getRound();\r\n        let encBalances = await that.ruby.methods.getBalance([that.account.publicKeySerialized()], currentRound + 1).call();\r\n        var encBalance = elgamal.unserialize(encBalances[0]);\r\n\r\n        var guess = await that.getGuess();\r\n\r\n        var balance = elgamal.decrypt(encBalance, that.account.privateKey(), guess);\r\n        console.log(\"Read balance successfully: \" + balance);\r\n        return balance;\r\n    }\r\n\r\n    /**\r\n    Synchronize the local account state with that in the Ruby contract.\r\n    Use this when we lose track of the local account state.\r\n    \r\n    @return A promise.\r\n    */\r\n    async syncAccountState () {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        let encState = await that.ruby.methods.getAccountState(that.account.publicKeySerialized()).call();\r\n        var encAvailable = elgamal.unserialize(encState['y_available']);\r\n        var encPending = elgamal.unserialize(encState['y_pending']);\r\n\r\n        var guess = await that.getGuess();\r\n\r\n        that.account.setAvailable(\r\n            elgamal.decrypt(encAvailable, that.account.privateKey(), guess)\r\n        );\r\n        that.account.setPending(\r\n            elgamal.decrypt(encPending, that.account.privateKey())\r\n        );\r\n        that.account._state.lastRollOver = await that.ruby.methods.last_roll_over(that.account.publicKeyHash()).call();\r\n        that.account._state.nonceUsed = true;\r\n\r\n        console.log(\"Account synchronized with contract: available = \", that.account.available(), \", pending = \", that.account.pending(), \", lastRollOver = \", that.account.lastRollOver());\r\n        return 0\r\n    }\r\n\r\n    /**\r\n    [Transaction]\r\n    Register a public/private key pair, stored in this client's Ruby account.\r\n    This key pair is used for private interaction with the Ruby contract.\r\n    NOTE: this key pair is NOT an Ethereum address, but instead, it should normally\r\n    be used together with an Ethereum account address for the connection between\r\n    Ruby and plain Ethereum token.\r\n\r\n    @param secret The private key. If not given, then a new public/private key pair is\r\n        generated, otherwise construct the public/private key pair form the secret.\r\n\r\n    @return A promise that is resolved (or rejected) with the execution status of the\r\n        registraction transaction.\r\n    */\r\n    async register (secret, registerGasLimit) {\r\n        var that = this;\r\n        if (secret === undefined) {\r\n            that.account.keypair = utils.createAccount();\r\n            that.account.aesKey = aes.generateKey();\r\n        } else {\r\n            that.account.keypair = utils.keyPairFromSecret(secret); \r\n            that.account.aesKey = aes.generateKey(secret);\r\n        }\r\n        let isRegistered = await ClientBase.registered(that.ruby, that.account.publicKeySerialized());\r\n        if (isRegistered) {\r\n            // This branch would recover the account previously bound to the secret, and the corresponding balance.\r\n            return await that.syncAccountState();\r\n        } else {\r\n\r\n            var [c, s] = utils.sign(that.ruby._address, that.account.keypair);\r\n            if (registerGasLimit === undefined)\r\n                registerGasLimit = 190000;\r\n            let transaction = that.ruby.methods.register(that.account.publicKeySerialized(), c, s)\r\n                .send({from: that.home, gas: registerGasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    console.log(\"Registration submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n                })\r\n                .on('receipt', () => {\r\n                    console.log(\"Registration successful.\");\r\n                })\r\n                .on('error', (error) => {\r\n                    that.account.keypair = undefined;\r\n                    console.log(\"Registration failed: \" + error);\r\n                });\r\n            return transaction;\r\n        }\r\n    }\r\n\r\n    async login(secret) {\r\n      var that = this;\r\n      if (secret === undefined) {\r\n        that.account.keypair = utils.createAccount();\r\n        that.account.aesKey = aes.generateKey();\r\n      } else {\r\n        that.account.keypair = utils.keyPairFromSecret(secret);\r\n        that.account.aesKey = aes.generateKey(secret);\r\n      }\r\n      let isRegistered = await ClientBase.registered(\r\n        that.ruby,\r\n        that.account.publicKeySerialized(),\r\n      );\r\n      if (isRegistered) {\r\n        // This branch would recover the account previously bound to the secret, and the corresponding balance.\r\n        return await that.syncAccountState();\r\n      } else {\r\n        console.log('Login failed: this ruby account is not exists');\r\n        return -1;\r\n      }\r\n    }\r\n\r\n    /**\r\n    [Transaction]\r\n    Mint a given amount of tokens in the Ruby account.\r\n    This essentially converts plain tokens to Ruby tokens that are encrypted in the Ruby contract.\r\n    In other words, X tokens are deducted from this client's home account (Ethereum address), and X Ruby\r\n    tokens are added to this client's Ruby account.\r\n\r\n    The amount is represented in terms of a pre-defined unit. For example, if one unit represents 0.01 ETH,\r\n    then an amount of 100 represents 1 ETH.\r\n\r\n    @param value The amount to be minted into the Ruby account, in terms of unit.\r\n\r\n    @return A promise that is resolved (or rejected) with the execution status of the mint transaction.\r\n    */\r\n    async mint (value) {\r\n        throw new Error(\"Mint not implemented.\",value);\r\n    }\r\n\r\n    /**\r\n    [Transaction]\r\n    Redeem a given amount of tokens from the Ruby account, if there is sufficient balance.\r\n    This essentially converts Ruby tokens to plain tokens, with X Ruby tokens deducted from\r\n    this client's Ruby account and X plain tokens added to this client's home account.\r\n\r\n    The amount is represented in terms of a pre-defined unit. For example, if one unit represents 0.01 ETH,\r\n    then an amount of 100 represents 1 ETH.\r\n\r\n    @param value The amount to be minted into the Ruby account, in terms of unit.\r\n\r\n    @return A promise that is resolved (or rejected) with the execution status of the mint transaction.\r\n    */\r\n    async redeem (value, redeemGasLimit) {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        that.checkValue();\r\n        var account = that.account;\r\n        var state = await account.update();\r\n        if (value > account.balance())\r\n            throw new Error(\"Requested redeem amount of \" + value + \" exceeds account balance of \" + account.balance() + \".\");\r\n        var wait = await that._away();\r\n        //var seconds = Math.ceil(wait / 1000);\r\n        var unit = that.round_base == 0 ? \"blocks\" : \"seconds\";\r\n\r\n        // Wait for the pending incoming cash to be merged into the main available balance.\r\n        if (value > state.available) {\r\n            console.log(\"[Pending unmerged] Your redeem has been queued. Please wait \" + wait + \" \" + unit + \" for the release of your funds... \");\r\n            return sleep(wait * that.roundUnitTime).then(() => that.redeem(value));\r\n        }\r\n        if (state.nonceUsed) {\r\n            console.log(\"[Nonce used] Your redeem has been queued. Please wait \" + wait + \" \" + unit + \", until the next round...\");\r\n            return sleep(wait * that.roundUnitTime).then(() => that.redeem(value));\r\n        }\r\n\r\n        if (that.round_base == 0) {\r\n            // Heuristic condition to help reduce the possibility of failed transaction.\r\n            // If the remaining window of the current round is less than 1/4-th of the round length, then we will wait until the next round.\r\n            if ((that.round_len / 4) >= wait) {\r\n                console.log(\"[Short window] Your redeem has been queued. Please wait \" + wait + \" \" + unit + \", until the next round...\");\r\n                return sleep(wait * that.roundUnitTime).then(() => this.redeem(value));\r\n            }\r\n        }\r\n\r\n        if (that.round_base == 1) {\r\n            // Heuristic condition to reduce the possibility of failed transaction.\r\n            // If the remaining time of the current round is less than the time of minig a block, then\r\n            // we should just wait until the next round for the redeem, otherwise\r\n            // the redeem proof might be verified on a newer contract status (because of\r\n            // rolling over in the next round) and get rejected.\r\n            if (that.blockMinedTime >= wait * that.roundUnitTime) {\r\n                console.log(\"[Short window] Your redeem has been queued. Please wait \" + wait + \" \" + unit + \", until the next round...\");\r\n                return sleep(wait * that.roundUnitTime).then(() => this.redeem(value));\r\n            }\r\n        }\r\n\r\n        console.log(\"Initiating redeem.\");\r\n\r\n        let currentRound = await that._getRound();\r\n        let encBalances = await that.ruby.methods.getBalance([account.publicKeySerialized()], currentRound).call();\r\n        var encBalance = elgamal.unserialize(encBalances[0]);\r\n        var encNewBalance = elgamal.serialize(elgamal.subPlain(encBalance, value));\r\n        \r\n        var proof = that.service.proveRedeem(\r\n            encNewBalance[0], \r\n            encNewBalance[1], \r\n            account.publicKeySerialized(), \r\n            state.lastRollOver, \r\n            that.home, \r\n            account.privateKey(),\r\n            state.available - value\r\n        ); \r\n        var u = bn128.serialize(utils.u(state.lastRollOver, account.privateKey()));\r\n\r\n        let encGuess = '0x' + aes.encrypt(new BN(account.available()).toString(16), account.aesKey);\r\n\r\n        if (redeemGasLimit === undefined)\r\n            redeemGasLimit = 3000000;\r\n        let transaction = that.ruby.methods.redeem(account.publicKeySerialized(), value, u, proof, encGuess)\r\n            .send({from: that.home, gas: redeemGasLimit})\r\n            .on('transactionHash', (hash) => {\r\n                console.log(\"redeem submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n            })\r\n            .on('receipt', async (receipt) => {\r\n                account._state = await account.update();\r\n                account._state.nonceUsed = true;\r\n                account._state.pending -= value;\r\n                console.log(\"redeem of \" + value + \" was successful (uses gas: \" + receipt[\"gasUsed\"] + \")\");  \r\n                console.log(\"Account state: available = \", that.account.available(), \", pending = \", that.account.pending(), \", lastRollOver = \", that.account.lastRollOver());\r\n\r\n            })\r\n            .on('error', (error) => {\r\n                console.log(\"redeem failed: \" + error);\r\n            });\r\n\r\n        return transaction;\r\n    }\r\n\r\n    /**\r\n    [Transaction]\r\n    Transfer a given amount of tokens from this Ruby account to a given receiver, if there is sufficient balance.\r\n    \r\n    The amount is represented in terms of a pre-defined unit. For example, if one unit represents 0.01 ETH,\r\n    then an amount of 100 represents 1 ETH.\r\n\r\n    @param receiver A serialized public key representing a Ruby receiver.\r\n    @param value The amount to be transfered, in terms of unit.\r\n    @param decoys An array of ruby users (represented by public keys) to anonymize the transfer.\r\n    @param transferGasLimit The max gas allowed to use for the transfer operation.\r\n\r\n    @return A promise that is resolved (or rejected) with the execution status of the mint transaction. \r\n    */\r\n    async transfer (receiver, value, decoys, transferGasLimit) {\r\n        /*\r\n        Estimation of running time for a transfer.\r\n        */\r\n        var estimate = (size, contract) => {\r\n            // this expression is meant to be a relatively close upper bound of the time that proving + a few verifications will take, as a function of anonset size\r\n            // this function should hopefully give you good round lengths also for 8, 16, 32, etc... if you have very heavy traffic, may need to bump it up (many verifications)\r\n            // i calibrated this on _my machine_. if you are getting transfer failures, you might need to bump up the constants, recalibrate yourself, etc.\r\n            return (Math.ceil(size * Math.log(size) / Math.log(2) * 20 + 5200) + (contract ? 20 : 0)) / 1000;\r\n            // the 20-millisecond buffer is designed to give the callback time to fire (see below).\r\n        };\r\n\r\n        /*\r\n        Swap two values in an array.\r\n        */\r\n        var swap = (y, i, j) => {\r\n            var temp = y[i];\r\n            y[i] = y[j];\r\n            y[j] = temp;\r\n        };\r\n\r\n        var that = this;\r\n        that.checkRegistered();\r\n        that.checkValue();\r\n\r\n        if (decoys === undefined)\r\n            decoys = [\"0x2113416df38f399d17efbf8e819bce71edf4224c3394e77d9f656d59fdc07bb10d71e8c0553939a16566141cc62a0f0b0f33041e8863c84bca22387f072c7a6f\", \"0x1eef7bd48f5b4452ff84796cac1f705571b2615c289aee732215801efbf6ddf2248087742b36d1d5d56ac9a164c26dc64692d841a3b2fb07b2fc691ad5eb7195\", \"0x0b9789644e3e9934e1a8de7fee5da9b6211f16a11c52dd079f59e5056009f74406cada714b1bb11d0dace644f4175d85b7a67ab3367c2221ff11dbb86631f632\", \"0x0b3546acfd90f8c2a9e9d35fe53b9673ae2fc281dcdcfaeafd290b852f256b5b2fc6f54d2874ed5f8840a1a525ed401fa741f44040bdef1c16ba985e5a0a0267\", \"0x1e2d3366fd942f345178635e6340c7efae729eaa8b26544aa4350266771ba6f32581f7eae4a86dd8f82dd3eb57dba3d5ea26e6916a75d10e951d17f0c7da4023\", \"0x078b13d654c4e6549040879e387e1c66dabdaa58874c2d9f896af97235cadd0e1571413da3217f3212224a1e740d0349bcdc1cce9347e32de16b9ac9e90f56c6\"];\r\n        receiver = receiver.trim();\r\n        decoys = decoys.map(decoy => decoy.trim());\r\n        \r\n        const anonymitySize = 2 + decoys.length;\r\n        if (anonymitySize & (anonymitySize - 1))\r\n            throw \"Size of anonymity set must be a power of 2!\";\r\n\r\n        // Check that the receiver is also registered\r\n        var serializedReceiver = bn128.encodedToSerialized(receiver);\r\n        let receiverRegistered = await ClientBase.registered(that.ruby, serializedReceiver);\r\n        if (!receiverRegistered)\r\n            throw new Error(\"Receiver has not been registered!\");\r\n\r\n        var account = that.account;\r\n        var state = await account.update();\r\n        if (value > account.balance())\r\n            throw \"Requested transfer amount of \" + value + \" exceeds account balance of \" + account.balance() + \".\";\r\n        var wait = await that._away();\r\n        var unit = that.round_base == 0 ? \"blocks\" : \"seconds\";\r\n\r\n        if (value > state.available) {\r\n            console.log(\"[Pending unmerged] Your transfer has been queued. Please wait \" + wait + \" \" + unit + \" for the release of your funds...\");\r\n            return sleep(wait * that.roundUnitTime).then(() => that.transfer(receiver, value, decoys, transferGasLimit));\r\n        }\r\n        if (state.nonceUsed) {\r\n            console.log(\"[Nonce used] Your transfer has been queued. Please wait \" + wait + \" \" + unit + \" until the next round...\");\r\n            return sleep(wait * that.roundUnitTime).then(() => that.transfer(receiver, value, decoys, transferGasLimit));\r\n        }\r\n\r\n        if (that.round_base == 0) {\r\n            // Heuristic condition to help reduce the possibility of failed transaction.\r\n            // If the remaining window of the current round is less than 1/4-th of the round length, then we will wait until the next round.\r\n            if ((that.round_len / 4) >= wait) {\r\n                console.log(\"[Short window] Your transfer has been queued. Please wait \" + wait + \" \" + unit + \", until the next round...\");\r\n                return sleep(wait * that.roundUnitTime).then(() => that.transfer(receiver, value, decoys, transferGasLimit));\r\n            }\r\n        }\r\n\r\n        if (that.round_base == 1) {\r\n            var estimated = estimate(anonymitySize, false);\r\n            if (estimated > that.round_len)\r\n                throw \"The anonymity size (\" + anonymitySize + \") you've requested might take longer than the round length (\" + that.round_len + \" seconds) to prove. Consider re-deploying, with an round length at least \" + Math.ceil(estimate(anonymitySize, true)) + \" seconds.\";\r\n            // Heuristic condition to help reduce the possibility of failed transaction.\r\n            // If the estimated execution time is longer than the remaining time of this round, then \r\n            // we should just wait until the round, otherwise it might happend that:\r\n            // This transfer's ZK proof is generated on Ruby contract status X, but after 'wait', the\r\n            // contract gets rolled over, leading to Ruby contract status Y, while this transfer will be\r\n            // verified on status Y and get rejected (this will likely happend because we estimate that the \r\n            // transfer cannot complete in this round and thus will not be included in any block).\r\n            if (estimated > wait) {\r\n                console.log(\"[Short window] Your transfer has been queued. Please wait \" + wait + \" \" + unit + \", until the next round...\");\r\n                return sleep(wait * that.roundUnitTime).then(() => that.transfer(receiver, value, decoys, transferGasLimit));\r\n            }\r\n        }\r\n        \r\n        console.log(\"Initiating transfer.\");\r\n\r\n        receiver = bn128.unserialize(serializedReceiver);\r\n        if (bn128.pointEqual(receiver, account.publicKey()))\r\n            throw new Error(\"Sending to yourself is currently unsupported.\");\r\n\r\n        decoys = decoys.map((decoy) => bn128.unserialize(bn128.encodedToSerialized(decoy)));\r\n\r\n        // Shuffle all participants\r\n        var y = [account.publicKey()]\r\n            .concat([receiver]).concat([]);\r\n            // .concat(decoys);\r\n        var index = [];\r\n        var m = y.length;\r\n        while (m != 0) {\r\n            var i = Math.floor(Math.random() * m);\r\n            m--;\r\n            swap(y, i, m);\r\n            if (bn128.pointEqual(y[m], account.publicKey()))\r\n                index[0] = m;\r\n            else if (bn128.pointEqual(y[m], receiver))\r\n                index[1] = m;\r\n        } \r\n\r\n        // make sure sender and receiver have opposite parity\r\n        if (index[0] % 2 == index[1] % 2) {\r\n                var temp = y[index[1]];\r\n                y[index[1]] = y[index[1] + (index[1] % 2 == 0 ? 1 : -1)];\r\n                y[index[1] + (index[1] % 2 == 0 ? 1 : -1)] = temp;\r\n                index[1] = index[1] + (index[1] % 2 == 0 ? 1 : -1);\r\n        }\r\n\r\n        var serializedY = y.map(bn128.serialize);\r\n\r\n        let currentRound = await that._getRound();\r\n        let encBalances = await that.ruby.methods.getBalance(serializedY, currentRound).call();\r\n\r\n        var unserialized = encBalances.map((ct) => elgamal.unserialize(ct)); \r\n        if (unserialized.some((ct) => ct[0].eq(bn128.zero) && ct[1].eq(bn128.zero)))\r\n            throw new Error(\"Please make sure all participants are registered.\");\r\n\r\n        var r = bn128.randomScalar();\r\n\r\n        var ciphertexts = y.map((party, i) => {\r\n            if (i == index[0])\r\n                return elgamal.encrypt(new BN(-value), party, r);\r\n            else if (i == index[1])\r\n                return elgamal.encrypt(new BN(value), party, r);\r\n            else\r\n                return elgamal.encrypt(new BN(0), party, r);\r\n        });\r\n        var C = ciphertexts.map(ct => ct[0]);\r\n        var D = ciphertexts[0][1]; // same for all ct[i][1] \r\n\r\n        var CL = unserialized.map((ct, i) => ct[0].add(C[i]));\r\n        var CR = unserialized.map((ct) => ct[1].add(D));\r\n\r\n        var proof = that.service.proveTransfer(\r\n            CL, CR, \r\n            C, D, \r\n            y, \r\n            state.lastRollOver, \r\n            account.privateKey(), \r\n            r, \r\n            value,\r\n            state.available - value,\r\n            index\r\n        );\r\n\r\n        var u = bn128.serialize(utils.u(state.lastRollOver, account.privateKey()));\r\n\r\n        C = C.map(bn128.serialize);\r\n        D = bn128.serialize(D);\r\n\r\n\r\n        /* Can't use this estimate here because it seems to modify the contract state, making the proof invalid... */\r\n        //var transferGas = await that.ruby.methods.transfer(C, D, serializedY, u, proof)\r\n            //.estimateGas({from: that.home, value: that.gasLimit, gas: that.gasLimit});\r\n        //console.log(\"Estimated transfer gas: \", transferGas);\r\n\r\n        var gasPrice = await this.web3.eth.getGasPrice();\r\n\r\n        if (transferGasLimit === undefined)\r\n            transferGasLimit = 5470000 + 400000 * decoys.length;\r\n        var maxFeeValue = that.web3.utils.toBN(new BigNumber(transferGasLimit * gasPrice)).toString();\r\n        let transaction = \r\n            that.ruby.methods.transfer(C, D, serializedY, u, proof)\r\n                .send({from: that.home, value: maxFeeValue, gas: transferGasLimit})\r\n                .on('transactionHash', (hash) => {\r\n                    that._transfers.add(hash);\r\n                    console.log(\"Transfer submitted (txHash = \\\"\" + hash + \"\\\")\");\r\n                })\r\n                .on('receipt', async (receipt) => {\r\n                    account._state = await account.update();\r\n                    account._state.nonceUsed = true;\r\n                    account._state.pending -= value;\r\n                    console.log(\"Transfer of \" + value + \" was successful (uses gas: \" + receipt[\"gasUsed\"] + \")\");  \r\n                    console.log(\"Account state: available = \", that.account.available(), \", pending = \", that.account.pending(), \", lastRollOver = \", that.account.lastRollOver());\r\n                })\r\n                .on('error', (error) => {\r\n                    console.log(\"Transfer failed: \" + error);\r\n                    throw new Error(error);\r\n                });\r\n\r\n        return transaction;\r\n    }\r\n\r\n    /**\r\n    [Transaction]\r\n    Transfer a given amount of tokens from this Ruby account to a given receiver, if there is sufficient balance.\r\n    \r\n    The amount is represented in terms of a pre-defined unit. For example, if one unit represents 0.01 ETH,\r\n    then an amount of 100 represents 1 ETH.\r\n\r\n    @param receiver A Client object.\r\n    @param value The amount to be transfered, in terms of unit.\r\n\r\n    @return A promise that is resolved (or rejected) with the execution status of the mint transaction. \r\n    */\r\n    async transferToClient (receiver, value) {\r\n        return this.transfer(receiver.account.publicKeyEncoded(), value);\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = ClientBase;\r\n","const bn128 = require('./bn128.js'); \r\n\r\n\r\nconst elgamal = {};\r\n\r\nelgamal.MAX_PLAIN = 2**32 - 1;\r\n\r\nelgamal.encrypt = (m, y, r) => {\r\n    if (r === undefined)\r\n        r = bn128.randomScalar(); \r\n    var CL = bn128.curve.g.mul(m).add(y.mul(r))\r\n    var CR = bn128.curve.g.mul(r); \r\n    return [CL, CR];\r\n};\r\n\r\n/**\r\nct is an ElGamal ciphertext, x is a BN.\r\nTODO: This could be slow if we don't provide an initial guess for the balance. Need to optimize.\r\n*/\r\nelgamal.decrypt = (ct, x, init_guess) => {\r\n    var CL = ct[0];\r\n    var CR = ct[1];\r\n    var gB = CL.add(CR.mul(x.redNeg()));\r\n\r\n    if (init_guess === undefined)\r\n        init_guess = 0;\r\n    var start = bn128.curve.g.mul(init_guess);\r\n\r\n    var accumulator = bn128.zero;\r\n    for (var i = 0; i < elgamal.MAX_PLAIN; i++) {\r\n        let guess = start.add(accumulator); \r\n        if (guess.eq(gB)) {\r\n            return init_guess + i;\r\n        }\r\n        guess = start.add(accumulator.neg());\r\n        if (guess.eq(gB)) {\r\n            return init_guess - i;\r\n        }\r\n        accumulator = accumulator.add(bn128.curve.g);\r\n    }\r\n    throw \"Unable to decrypt the ciphertext: \" + ct;\r\n};\r\n\r\nelgamal.addPlain = (ct, plain) => {\r\n    var cL = ct[0].add(bn128.curve.g.mul(plain));\r\n    var cR = ct[1];\r\n    return [cL, cR];\r\n};\r\n\r\nelgamal.subPlain = (ct, plain) => {\r\n    return elgamal.addPlain(ct, -plain);\r\n};\r\n\r\nelgamal.serialize = (ct) => {\r\n    return [bn128.serialize(ct[0]), bn128.serialize(ct[1])];\r\n};\r\n\r\nelgamal.unserialize = (serialized) => {\r\n    return [bn128.unserialize(serialized[0]), bn128.unserialize(serialized[1])];\r\n};\r\n\r\nmodule.exports = elgamal;\r\n","export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&id=4cc6bfad&prod&scoped=true&lang=css&\"","const ABICoder = require('web3-eth-abi');\r\nconst BN = require('bn.js');\r\n\r\nconst bn128 = require('../utils/bn128.js');\r\nconst utils = require('../utils/utils.js');\r\nconst { Convolver, FieldVector, FieldVectorPolynomial, GeneratorParams, GeneratorVector, PolyCommitment, Polynomial } = require('./algebra.js');\r\nconst InnerProductProver = require('./innerproduct.js');\r\n\r\nclass TransferProof {\r\n    constructor() {\r\n        this.serialize = () => { // please initialize this before calling this method...\r\n            var result = \"0x\";\r\n            result += bn128.representation(this.BA).slice(2);\r\n            result += bn128.representation(this.BS).slice(2);\r\n            result += bn128.representation(this.A).slice(2);\r\n            result += bn128.representation(this.B).slice(2);\r\n\r\n            this.CLnG.forEach((CLnG_k) => { result += bn128.representation(CLnG_k).slice(2); });\r\n            this.CRnG.forEach((CRnG_k) => { result += bn128.representation(CRnG_k).slice(2); });\r\n            this.C_0G.forEach((C_0G_k) => { result += bn128.representation(C_0G_k).slice(2); });\r\n            this.DG.forEach((DG_k) => { result += bn128.representation(DG_k).slice(2); });\r\n            this.y_0G.forEach((y_0G_k) => { result += bn128.representation(y_0G_k).slice(2); });\r\n            this.gG.forEach((gG_k) => { result += bn128.representation(gG_k).slice(2); });\r\n            this.C_XG.forEach((C_XG_k) => { result += bn128.representation(C_XG_k).slice(2); });\r\n            this.y_XG.forEach((y_XG_k) => { result += bn128.representation(y_XG_k).slice(2); });\r\n            this.f.getVector().forEach((f_k) => { result += bn128.bytes(f_k).slice(2); });\r\n\r\n            result += bn128.bytes(this.z_A).slice(2);\r\n\r\n            this.tCommits.getVector().forEach((commit) => {\r\n                result += bn128.representation(commit).slice(2);\r\n            });\r\n            result += bn128.bytes(this.tHat).slice(2);\r\n            result += bn128.bytes(this.mu).slice(2);\r\n\r\n            result += bn128.bytes(this.c).slice(2);\r\n            result += bn128.bytes(this.s_sk).slice(2);\r\n            result += bn128.bytes(this.s_r).slice(2);\r\n            result += bn128.bytes(this.s_b).slice(2);\r\n            result += bn128.bytes(this.s_tau).slice(2);\r\n\r\n            result += this.ipProof.serialize().slice(2);\r\n\r\n            return result;\r\n        }\r\n    }\r\n}\r\n\r\nclass TransferProver {\r\n    constructor() {\r\n        var params = new GeneratorParams(64);\r\n        var ipProver = new InnerProductProver();\r\n\r\n        var recursivePolynomials = (list, accum, a, b) => {\r\n            // as, bs are log(N)-lengthed.\r\n            // returns N-length list of coefficient vectors\r\n            // should take about N log N to compute.\r\n            if (a.length == 0) {\r\n                list.push(accum.coefficients);\r\n                return;\r\n            }\r\n            var aTop = a.pop();\r\n            var bTop = b.pop();\r\n            var left = new Polynomial([aTop.redNeg(), new BN(1).toRed(bn128.q).redSub(bTop)]);\r\n            var right = new Polynomial([aTop, bTop]);\r\n            recursivePolynomials(list, accum.mul(left), a, b);\r\n            recursivePolynomials(list, accum.mul(right), a, b);\r\n            a.push(aTop);\r\n            b.push(bTop);\r\n        }\r\n\r\n        this.generateProof = (statement, witness) => {\r\n            var proof = new TransferProof();\r\n\r\n            var statementHash = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2]',\r\n                'bytes32[2][]',\r\n                'uint256',\r\n            ], [\r\n                statement['CLn'].map(bn128.serialize),\r\n                statement['CRn'].map(bn128.serialize),\r\n                statement['C'].map(bn128.serialize),\r\n                bn128.serialize(statement['D']),\r\n                statement['y'].map(bn128.serialize),\r\n                statement['epoch'],\r\n            ]));\r\n\r\n            statement['CLn'] = new GeneratorVector(statement['CLn']);\r\n            statement['CRn'] = new GeneratorVector(statement['CRn']);\r\n            statement['C'] = new GeneratorVector(statement['C']);\r\n            statement['y'] = new GeneratorVector(statement['y']);\r\n\r\n            witness['bTransfer'] = new BN(witness['bTransfer']).toRed(bn128.q);\r\n            witness['bDiff'] = new BN(witness['bDiff']).toRed(bn128.q);\r\n\r\n            var number = witness['bTransfer'].add(witness['bDiff'].shln(32)); // shln a red? check\r\n            var aL = new FieldVector(number.toString(2, 64).split(\"\").reverse().map((i) => new BN(i, 2).toRed(bn128.q)));\r\n            var aR = aL.plus(new BN(1).toRed(bn128.q).redNeg());\r\n            var alpha = bn128.randomScalar();\r\n            proof.BA = params.commit(alpha, aL, aR);\r\n            var sL = new FieldVector(Array.from({ length: 64 }).map(bn128.randomScalar));\r\n            var sR = new FieldVector(Array.from({ length: 64 }).map(bn128.randomScalar));\r\n            var rho = bn128.randomScalar(); // already reduced\r\n            proof.BS = params.commit(rho, sL, sR);\r\n\r\n            var N = statement['y'].length();\r\n            if (N & (N - 1))\r\n                throw \"Size must be a power of 2!\"; // probably unnecessary... this won't be called directly.\r\n            var m = new BN(N).bitLength() - 1; // assuming that N is a power of 2?\r\n            // DON'T need to extend the params anymore. 64 will always be enough.\r\n            var r_A = bn128.randomScalar();\r\n            var r_B = bn128.randomScalar();\r\n            var a = new FieldVector(Array.from({ length: 2 * m }).map(bn128.randomScalar));\r\n            var b = new FieldVector((new BN(witness['index'][1]).toString(2, m) + new BN(witness['index'][0]).toString(2, m)).split(\"\").reverse().map((i) => new BN(i, 2).toRed(bn128.q)));\r\n            var c = a.hadamard(b.times(new BN(2).toRed(bn128.q)).negate().plus(new BN(1).toRed(bn128.q))); // check this\r\n            var d = a.hadamard(a).negate();\r\n            var e = new FieldVector([a.getVector()[0].redMul(a.getVector()[m]), a.getVector()[0].redMul(a.getVector()[m])]);\r\n            var f = new FieldVector([a.getVector()[b.getVector()[0].toNumber() * m], a.getVector()[b.getVector()[m].toNumber() * m].redNeg()]);\r\n\r\n            proof.A = params.commit(r_A, a.concat(d).concat(e));\r\n            proof.B = params.commit(r_B, b.concat(c).concat(f));\r\n\r\n            var v = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(statementHash),\r\n                bn128.serialize(proof.BA),\r\n                bn128.serialize(proof.BS),\r\n                bn128.serialize(proof.A),\r\n                bn128.serialize(proof.B),\r\n            ]));\r\n\r\n            var phi = Array.from({ length: m }).map(bn128.randomScalar);\r\n            var chi = Array.from({ length: m }).map(bn128.randomScalar);\r\n            var psi = Array.from({ length: m }).map(bn128.randomScalar);\r\n            var omega = Array.from({ length: m }).map(bn128.randomScalar);\r\n\r\n            var P = [];\r\n            var Q = [];\r\n            recursivePolynomials(P, new Polynomial(), a.getVector().slice(0, m), b.getVector().slice(0, m));\r\n            recursivePolynomials(Q, new Polynomial(), a.getVector().slice(m), b.getVector().slice(m));\r\n            P = Array.from({ length: m }).map((_, k) => new FieldVector(P.map((P_i) => P_i[k])));\r\n            Q = Array.from({ length: m }).map((_, k) => new FieldVector(Q.map((Q_i) => Q_i[k])));\r\n\r\n            proof.CLnG = Array.from({ length: m }).map((_, k) => statement['CLn'].commit(P[k]).add(statement['y'].getVector()[witness['index'][0]].mul(phi[k])));\r\n            proof.CRnG = Array.from({ length: m }).map((_, k) => statement['CRn'].commit(P[k]).add(params.getG().mul(phi[k])));\r\n            proof.C_0G = Array.from({ length: m }).map((_, k) => statement['C'].commit(P[k]).add(statement['y'].getVector()[witness['index'][0]].mul(chi[k])));\r\n            proof.DG = Array.from({ length: m }).map((_, k) => params.getG().mul(chi[k]));\r\n            proof.y_0G = Array.from({ length: m }).map((_, k) => statement['y'].commit(P[k]).add(statement['y'].getVector()[witness['index'][0]].mul(psi[k])));\r\n            proof.gG = Array.from({ length: m }).map((_, k) => params.getG().mul(psi[k]));\r\n            proof.C_XG = Array.from({ length: m }).map((_, k) => statement['D'].mul(omega[k]));\r\n            proof.y_XG = Array.from({ length: m }).map((_, k) => params.getG().mul(omega[k]));\r\n            var vPow = new BN(1).toRed(bn128.q);\r\n            for (let i = 0; i < N; i++) { // could turn this into a complicated reduce, but...\r\n                var temp = params.getG().mul(witness['bTransfer'].redMul(vPow));\r\n                var poly = i % 2 ? Q : P; // clunky, i know, etc. etc.\r\n                proof.C_XG = proof.C_XG.map((C_XG_k, k) => C_XG_k.add(temp.mul(poly[k].getVector()[(witness['index'][0] + N - (i - i % 2)) % N].redNeg().redAdd(poly[k].getVector()[(witness['index'][1] + N - (i - i % 2)) % N]))));\r\n                if (i != 0)\r\n                    vPow = vPow.redMul(v);\r\n            }\r\n\r\n            var w = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n                'bytes32[2][]',\r\n            ], [\r\n                bn128.bytes(v),\r\n                proof.CLnG.map(bn128.serialize),\r\n                proof.CRnG.map(bn128.serialize),\r\n                proof.C_0G.map(bn128.serialize),\r\n                proof.DG.map(bn128.serialize),\r\n                proof.y_0G.map(bn128.serialize),\r\n                proof.gG.map(bn128.serialize),\r\n                proof.C_XG.map(bn128.serialize),\r\n                proof.y_XG.map(bn128.serialize),\r\n            ]));\r\n\r\n            proof.f = b.times(w).add(a);\r\n            proof.z_A = r_B.redMul(w).redAdd(r_A);\r\n\r\n            var y = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n            ], [\r\n                bn128.bytes(w), // that's it?\r\n            ]));\r\n\r\n            var ys = [new BN(1).toRed(bn128.q)];\r\n            for (let i = 1; i < 64; i++) { // it would be nice to have a nifty functional way of doing this.\r\n                ys.push(ys[i - 1].redMul(y));\r\n            }\r\n            ys = new FieldVector(ys); // could avoid this line by starting ys as a fieldvector and using \"plus\". not going to bother.\r\n            var z = utils.hash(bn128.bytes(y));\r\n            var zs = [z.redPow(new BN(2)), z.redPow(new BN(3))];\r\n            var twos = [new BN(1).toRed(bn128.q)];\r\n            for (let i = 1; i < 32; i++) {\r\n                twos.push(twos[i - 1].redMul(new BN(2).toRed(bn128.q)));\r\n            }\r\n            var twoTimesZs = [];\r\n            for (let i = 0; i < 2; i++) {\r\n                for (var j = 0; j < 32; j++) {\r\n                    twoTimesZs.push(zs[i].redMul(twos[j]));\r\n                }\r\n            }\r\n            twoTimesZs = new FieldVector(twoTimesZs);\r\n            var lPoly = new FieldVectorPolynomial(aL.plus(z.redNeg()), sL);\r\n            var rPoly = new FieldVectorPolynomial(ys.hadamard(aR.plus(z)).add(twoTimesZs), sR.hadamard(ys));\r\n            var tPolyCoefficients = lPoly.innerProduct(rPoly); // just an array of BN Reds... should be length 3\r\n            var polyCommitment = new PolyCommitment(params, tPolyCoefficients);\r\n            proof.tCommits = new GeneratorVector(polyCommitment.getCommitments()); // just 2 of them\r\n\r\n            var x = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(z),\r\n                ...polyCommitment.getCommitments().map(bn128.serialize),\r\n            ]));\r\n\r\n            var evalCommit = polyCommitment.evaluate(x);\r\n            proof.tHat = evalCommit.getX();\r\n            var tauX = evalCommit.getR(); // no longer public...\r\n            proof.mu = alpha.redAdd(rho.redMul(x));\r\n\r\n            var CRnR = bn128.zero;\r\n            var y_0R = bn128.zero;\r\n            var y_XR = bn128.zero;\r\n            var DR = bn128.zero;\r\n            var gR = bn128.zero;\r\n            var p = new FieldVector(Array.from({ length: N }).map(() => new BN().toRed(bn128.q))); // evaluations of poly_0 and poly_1 at w.\r\n            var q = new FieldVector(Array.from({ length: N }).map(() => new BN().toRed(bn128.q))); // verifier will compute these using f.\r\n\r\n            var wPow = new BN(1).toRed(bn128.q);\r\n            for (var k = 0; k < m; k++) {\r\n                CRnR = CRnR.add(params.getG().mul(phi[k].redNeg().redMul(wPow)));\r\n                DR = DR.add(params.getG().mul(chi[k].redNeg().redMul(wPow)));\r\n                y_0R = y_0R.add(statement['y'].getVector()[witness['index'][0]].mul(psi[k].redNeg().redMul(wPow)));\r\n                gR = gR.add(params.getG().mul(psi[k].redNeg().redMul(wPow)));\r\n                y_XR = y_XR.add(proof.y_XG[k].mul(wPow.neg()));\r\n                p = p.add(P[k].times(wPow));\r\n                q = q.add(Q[k].times(wPow));\r\n                wPow = wPow.redMul(w);\r\n            }\r\n            CRnR = CRnR.add(statement['CRn'].getVector()[witness['index'][0]].mul(wPow));\r\n            y_0R = y_0R.add(statement['y'].getVector()[witness['index'][0]].mul(wPow));\r\n            DR = DR.add(statement['D'].mul(wPow));\r\n            gR = gR.add(params.getG().mul(wPow));\r\n            p = p.add(new FieldVector(Array.from({ length: N }).map((_, i) => i == witness['index'][0] ? wPow : new BN().toRed(bn128.q))));\r\n            q = q.add(new FieldVector(Array.from({ length: N }).map((_, i) => i == witness['index'][1] ? wPow : new BN().toRed(bn128.q))));\r\n\r\n            var convolver = new Convolver();\r\n            var y_p = convolver.convolution(p, statement['y']);\r\n            var y_q = convolver.convolution(q, statement['y']);\r\n            vPow = new BN(1).toRed(bn128.q);\r\n            for (let i = 0; i < N; i++) {\r\n                var y_poly = i % 2 ? y_q : y_p;\r\n                y_XR = y_XR.add(y_poly.getVector()[Math.floor(i / 2)].mul(vPow));\r\n                if (i > 0)\r\n                    vPow = vPow.redMul(v);\r\n            }\r\n\r\n            var k_sk = bn128.randomScalar();\r\n            var k_r = bn128.randomScalar();\r\n            var k_b = bn128.randomScalar();\r\n            var k_tau = bn128.randomScalar();\r\n\r\n            var A_y = gR.mul(k_sk);\r\n            var A_D = params.getG().mul(k_r);\r\n            var A_b = params.getG().mul(k_b).add(DR.mul(zs[0].redNeg()).add(CRnR.mul(zs[1])).mul(k_sk));\r\n            var A_X = y_XR.mul(k_r);\r\n            var A_t = params.getG().mul(k_b.redNeg()).add(params.getH().mul(k_tau));\r\n            var A_u = utils.gEpoch(statement['epoch']).mul(k_sk);\r\n\r\n            proof.c = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n                'bytes32[2]',\r\n            ], [\r\n                bn128.bytes(x),\r\n                bn128.serialize(A_y),\r\n                bn128.serialize(A_D),\r\n                bn128.serialize(A_b),\r\n                bn128.serialize(A_X),\r\n                bn128.serialize(A_t),\r\n                bn128.serialize(A_u),\r\n            ]));\r\n\r\n            proof.s_sk = k_sk.redAdd(proof.c.redMul(witness['sk']));\r\n            proof.s_r = k_r.redAdd(proof.c.redMul(witness['r']));\r\n            proof.s_b = k_b.redAdd(proof.c.redMul(witness['bTransfer'].redMul(zs[0]).redAdd(witness['bDiff'].redMul(zs[1])).redMul(wPow)));\r\n            proof.s_tau = k_tau.redAdd(proof.c.redMul(tauX.redMul(wPow)));\r\n\r\n            var gs = params.getGs();\r\n            var hPrimes = params.getHs().hadamard(ys.invert());\r\n            var hExp = ys.times(z).add(twoTimesZs);\r\n            let P2 = proof.BA.add(proof.BS.mul(x)).add(gs.sum().mul(z.redNeg())).add(hPrimes.commit(hExp)); // rename of P\r\n            P2 = P2.add(params.getH().mul(proof.mu.redNeg())); // Statement P of protocol 1. should this be included in the calculation of v...?\r\n\r\n            var o = utils.hash(ABICoder.encodeParameters([\r\n                'bytes32',\r\n            ], [\r\n                bn128.bytes(proof.c),\r\n            ]));\r\n\r\n            var u_x = params.getG().mul(o); // Begin Protocol 1. this is u^x in Protocol 1. use our g for their u, our o for their x.\r\n            P2 = P2.add(u_x.mul(proof.tHat)); // corresponds to P' in protocol 1.\r\n            var primeBase = new GeneratorParams(u_x, gs, hPrimes);\r\n            var ipStatement = { 'primeBase': primeBase, 'P': P2 };\r\n            var ipWitness = { 'l': lPoly.evaluate(x), 'r': rPoly.evaluate(x) };\r\n            proof.ipProof = ipProver.generateProof(ipStatement, ipWitness, o);\r\n\r\n            return proof;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = TransferProver;\r\n","const bn128 = require('../utils/bn128.js');\r\nconst utils = require('../utils/utils.js');\r\nconst BN = require('bn.js');\r\nconst { soliditySha3 } = require('web3-utils');\r\n\r\nclass GeneratorParams {\r\n    constructor(h, gs, hs) { // doing double duty also as a \"VectorBase\". comes empty\r\n        var g = utils.mapInto(soliditySha3(\"G\"));\r\n        if (typeof(h) == 'number') {\r\n            var gsInnards = [];\r\n            var hsInnards = []\r\n            for (var i = 0; i < h; i++) {\r\n                gsInnards.push(utils.mapInto(soliditySha3(\"G\", i)));\r\n                hsInnards.push(utils.mapInto(soliditySha3(\"H\", i)));\r\n            }\r\n            h = utils.mapInto(soliditySha3(\"H\"));\r\n            gs = new GeneratorVector(gsInnards);\r\n            hs = new GeneratorVector(hsInnards);\r\n        }\r\n\r\n        this.getG = () => { return g; };\r\n        this.getH = () => { return h; };\r\n        this.getGs = () => { return gs; };\r\n        this.getHs = () => { return hs; };\r\n\r\n        this.commit = (blinding, gExp, hExp) => {\r\n            var result = h.mul(blinding);\r\n            var gsVector = gs.getVector();\r\n            gExp.getVector().forEach((gExp, i) => {\r\n                result = result.add(gsVector[i].mul(gExp));\r\n            });\r\n            if (hExp) {\r\n                var hsVector = hs.getVector();\r\n                hExp.getVector().forEach((hExp, i) => { // swap the order and enclose this in an if (hExp) if block if you want it optional.\r\n                    result = result.add(hsVector[i].mul(hExp));\r\n                });\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n}\r\n\r\nclass FieldVector {\r\n    constructor(vector) {\r\n        this.getVector = () => { return vector; };\r\n        this.length = () => { return vector.length; };\r\n        this.slice = (begin, end) => {\r\n            return new FieldVector(vector.slice(begin, end));\r\n        };\r\n\r\n        this.add = (other) => {\r\n            var innards = other.getVector();\r\n            return new FieldVector(vector.map((elem, i) => elem.redAdd(innards[i])));\r\n        };\r\n\r\n        this.plus = (constant) => { // confusingly named...\r\n            return new FieldVector(vector.map((elem) => elem.redAdd(constant)));\r\n        };\r\n\r\n        this.sum = () => {\r\n            return vector.reduce((accum, cur) => accum.redAdd(cur), new BN(0).toRed(bn128.q));\r\n        };\r\n\r\n        this.negate = () => {\r\n            return new FieldVector(vector.map((elem) => elem.redNeg()));\r\n        };\r\n\r\n        this.subtract = (other) => {\r\n            return this.add(other.negate());\r\n        };\r\n\r\n        this.hadamard = (other) => {\r\n            var innards = other.getVector();\r\n            return new FieldVector(vector.map((elem, i) => elem.redMul(innards[i])));\r\n        };\r\n\r\n        this.invert = () => {\r\n            return new FieldVector(vector.map((elem) => elem.redInvm()));\r\n        };\r\n\r\n        this.extract = (parity) => {\r\n            return new FieldVector(vector.filter((_, i) => i % 2 == parity));\r\n        };\r\n\r\n        this.flip = () => {\r\n            var size = vector.length;\r\n            return new FieldVector(Array.from({ length: size }).map((_, i) => vector[(size - i) % size]));\r\n        };\r\n\r\n        this.concat = (other) => {\r\n            return new FieldVector(vector.concat(other.getVector()));\r\n        };\r\n\r\n        this.times = (constant) => {\r\n            return new FieldVector(vector.map((elem) => elem.redMul(constant)));\r\n        };\r\n\r\n        this.innerProduct = (other) => {\r\n            var innards = other.getVector();\r\n            return vector.reduce((accum, cur, i) => accum.redAdd(cur.redMul(innards[i])), new BN(0).toRed(bn128.q));\r\n        };\r\n    }\r\n}\r\n\r\nclass GeneratorVector {\r\n    constructor(vector) {\r\n        this.getVector = () => { return vector; };\r\n        this.length = () => { return vector.length; };\r\n        this.slice = (begin, end) => {\r\n            return new GeneratorVector(vector.slice(begin, end));\r\n        };\r\n\r\n        this.commit = (exponents) => {\r\n            var innards = exponents.getVector();\r\n            return vector.reduce((accum, cur, i) => accum.add(cur.mul(innards[i])), bn128.zero);\r\n        };\r\n\r\n        this.sum = () => {\r\n            return vector.reduce((accum, cur) => accum.add(cur), bn128.zero);\r\n        }\r\n\r\n        this.add = (other) => {\r\n            var innards = other.getVector();\r\n            return new GeneratorVector(vector.map((elem, i) => elem.add(innards[i])));\r\n        };\r\n\r\n        this.hadamard = (exponents) => {\r\n            var innards = exponents.getVector();\r\n            return new GeneratorVector(vector.map((elem, i) => elem.mul(innards[i])));\r\n        };\r\n\r\n        this.negate = () => {\r\n            return new GeneratorVector(vector.map((elem) => elem.neg()));\r\n        };\r\n\r\n        this.times = (constant) => {\r\n            return new GeneratorVector(vector.map((elem) => elem.mul(constant)));\r\n        };\r\n\r\n        this.extract = (parity) => {\r\n            return new GeneratorVector(vector.filter((_, i) => i % 2 == parity));\r\n        };\r\n\r\n        this.concat = (other) => {\r\n            return new GeneratorVector(vector.concat(other.getVector()));\r\n        };\r\n    }\r\n}\r\n\r\nclass Convolver {\r\n    constructor() {\r\n        var unity = new BN(\"14a3074b02521e3b1ed9852e5028452693e87be4e910500c7ba9bbddb2f46edd\", 16).toRed(bn128.q);\r\n        // this can technically be \"static\" (as in the \"module pattern\", like bn128), but...\r\n\r\n        var fft = (input, inverse) => { // crazy... i guess this will work for both points and scalars?\r\n            var length = input.length();\r\n            if (length == 1) {\r\n                return input;\r\n            }\r\n            if (length % 2 != 0) {\r\n                throw \"Input size must be a power of 2!\";\r\n            }\r\n            var omega = unity.redPow(new BN(1).shln(28).div(new BN(length)));\r\n            if (inverse) {\r\n                omega = omega.redInvm();\r\n            }\r\n            var even = fft(input.extract(0), inverse);\r\n            var odd = fft(input.extract(1), inverse);\r\n            var omegas = [new BN(1).toRed(bn128.q)];\r\n            for (var i = 1; i < length / 2; i++) {\r\n                omegas.push(omegas[i - 1].redMul(omega));\r\n            }\r\n            omegas = new FieldVector(omegas);\r\n            var result = even.add(odd.hadamard(omegas)).concat(even.add(odd.hadamard(omegas).negate()));\r\n            if (inverse) {\r\n                result = result.times(new BN(2).toRed(bn128.q).redInvm());\r\n            }\r\n            return result;\r\n        };\r\n\r\n        this.convolution = (exponent, base) => { // returns only even-indexed outputs of convolution!\r\n            var size = base.length();\r\n            var temp = fft(base, false).hadamard(fft(exponent.flip(), false));\r\n            return fft(temp.slice(0, size / 2).add(temp.slice(size / 2)).times(new BN(2).toRed(bn128.q).redInvm()), true);\r\n            // using the optimization described here https://dsp.stackexchange.com/a/30699\r\n        };\r\n    }\r\n}\r\n\r\nclass FieldVectorPolynomial {\r\n    constructor(...coefficients) {\r\n        this.getCoefficients = () => {\r\n            return coefficients;\r\n        };\r\n\r\n        this.evaluate = (x) => {\r\n            var result = coefficients[0];\r\n            var accumulator = x;\r\n            coefficients.slice(1).forEach((coefficient) => {\r\n                result = result.add(coefficient.times(accumulator));\r\n                accumulator = accumulator.redMul(x);\r\n            });\r\n            return result;\r\n        };\r\n\r\n        this.innerProduct = (other) => {\r\n            var innards = other.getCoefficients();\r\n            var result = Array(coefficients.length + innards.length - 1).fill(new BN(0).toRed(bn128.q));\r\n            coefficients.forEach((mine, i) => {\r\n                innards.forEach((theirs, j) => {\r\n                    result[i + j] = result[i + j].redAdd(mine.innerProduct(theirs));\r\n                });\r\n            });\r\n            return result; // test this\r\n        };\r\n    }\r\n}\r\n\r\nclass PedersenCommitment {\r\n    constructor(params, x, r) {\r\n        this.getX = () => { return x; };\r\n        this.getR = () => { return r; };\r\n\r\n        this.commit = () => {\r\n            return params.getG().mul(x).add(params.getH().mul(r));\r\n        };\r\n\r\n        this.add = (other) => {\r\n            return new PedersenCommitment(params, x.redAdd(other.getX()), r.redAdd(other.getR()));\r\n        };\r\n\r\n        this.times = (exponent) => {\r\n            return new PedersenCommitment(params, x.redMul(exponent), r.redMul(exponent));\r\n        };\r\n    }\r\n}\r\n\r\nclass PolyCommitment {\r\n    constructor(params, coefficients) {\r\n        var coefficientCommitments = [new PedersenCommitment(params, coefficients[0], new BN(0).toRed(bn128.q))];\r\n        coefficients.slice(1).forEach((coefficient) => {\r\n            coefficientCommitments.push(new PedersenCommitment(params, coefficient, bn128.randomScalar()));\r\n        });\r\n\r\n        this.getCommitments = () => { // ignore the first one\r\n            return coefficientCommitments.slice(1).map((commitment) => commitment.commit());\r\n        };\r\n\r\n        this.evaluate = (x) => {\r\n            var result = coefficientCommitments[0];\r\n            var accumulator = x; // slightly uncomfortable that this starts at 1, but... actutally faster.\r\n            coefficientCommitments.slice(1).forEach((commitment) => {\r\n                result = result.add(commitment.times(accumulator));\r\n                accumulator = accumulator.redMul(x);\r\n            });\r\n            return result;\r\n        };\r\n    }\r\n}\r\n\r\nclass Polynomial {\r\n    constructor(coefficients) {\r\n        this.coefficients = coefficients ? coefficients : [new BN(1).toRed(bn128.q)]; // vector of coefficients, _little_ endian.\r\n\r\n        this.mul = (other) => { // i assume that other is linear _at most_ with coeffs.length == 2.\r\n            // could use FFTs to make this faster, yada yada\r\n            var product = this.coefficients.map((coefficient_i) => coefficient_i.redMul(other.coefficients[0]));\r\n            product.push(new BN().toRed(bn128.q));\r\n            if (other.coefficients[1].eqn(1)) {\r\n                product = product.map((product_i, i) => i > 0 ? product_i.redAdd(this.coefficients[i - 1]) : product_i);\r\n            }\r\n            return new Polynomial(product);\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = { GeneratorParams, FieldVector, GeneratorVector, Convolver, FieldVectorPolynomial, PolyCommitment, Polynomial };\r\n","module.exports = __webpack_public_path__ + \"img/footer.0fd2b650.png\";","const crypto = require('crypto');\r\n\r\n\r\nconst aes = {};\r\n\r\naes.generateKey = (secret) => {\r\n    if (secret == undefined) {\r\n        return crypto.randomBytes(16);\r\n    }\r\n    else {\r\n        const hash = crypto.createHash('sha512');\r\n        hash.update(secret + 'AES128GCM');\r\n        var key = hash.digest().slice(0, 16);\r\n        return key;\r\n    }\r\n};\r\n\r\naes.encrypt = (msg, key) => {\r\n    var iv = crypto.randomBytes(16);\r\n    var cipher = crypto.createCipheriv('aes-128-gcm', key, iv);\r\n    var ct = cipher.update(msg, 'utf8');\r\n    ct = Buffer.concat([ct, cipher.final()]);\r\n    return Buffer.concat([iv, cipher.getAuthTag(), ct]).toString('hex'); \r\n};\r\n\r\naes.decrypt = (ciphertext, key) => {\r\n    var ct = Buffer.from(ciphertext, 'hex');\r\n    var iv = ct.slice(0, 16);\r\n    var authTag = ct.slice(16, 32);\r\n    var decipher = crypto.createDecipheriv('aes-128-gcm', key, iv);\r\n    decipher.setAuthTag(authTag);\r\n    var msg = decipher.update(ct.slice(32)).toString('utf8');\r\n    return msg;\r\n};\r\n\r\nmodule.exports = aes;\r\n","/* eslint-disable no-constant-condition */\r\nconst bn128 = require('./bn128.js');\r\nconst crypto = require('crypto');\r\nconst BN = require('bn.js');\r\nconst ABICoder = require('web3-eth-abi');\r\nconst { soliditySha3 } = require('web3-utils');\r\n\r\nconst utils = {};\r\n\r\n\r\nutils.randomUint256 = () => {\r\n    return new BN(crypto.randomBytes(32), 16);\r\n};\r\n\r\n// Schnorr signature\r\n// Reference: https://en.wikipedia.org/wiki/Schnorr_signature\r\nutils.sign = (address, keypair) => {\r\n    var k = bn128.randomScalar();\r\n    var K = bn128.curve.g.mul(k);\r\n    var c = utils.hash(ABICoder.encodeParameters([\r\n        'address',\r\n        'bytes32[2]',\r\n        'bytes32[2]',\r\n    ], [\r\n        address,\r\n        bn128.serialize(keypair['y']),\r\n        bn128.serialize(K),\r\n    ]));\r\n\r\n    var s = c.redMul(keypair['x']).redAdd(k);\r\n    return [bn128.bytes(c), bn128.bytes(s)];\r\n};\r\n\r\nutils.createAccount = () => {\r\n    var x = bn128.randomScalar();\r\n    var y = bn128.curve.g.mul(x);\r\n    return { 'x': x, 'y': y };\r\n};\r\n\r\nutils.keyPairFromSecret = (secret) => {\r\n    var x = utils.hash(secret + \"ETH\"); \r\n    var y = bn128.curve.g.mul(x);\r\n    return {'x': x, 'y': y}; \r\n};\r\n\r\nutils.mapInto = (seed) => { // seed is flattened 0x + hex string\r\n    var seed_red = new BN(seed.slice(2), 16).toRed(bn128.p);\r\n    var p_1_4 = bn128.curve.p.add(new BN(1)).div(new BN(4));\r\n    while (true) {\r\n        var y_squared = seed_red.redPow(new BN(3)).redAdd(new BN(3).toRed(bn128.p));\r\n        var y = y_squared.redPow(p_1_4);\r\n        if (y.redPow(new BN(2)).eq(y_squared)) {\r\n            return bn128.curve.point(seed_red.fromRed(), y.fromRed());\r\n        }\r\n        seed_red.redIAdd(new BN(1).toRed(bn128.p));\r\n    }\r\n};\r\n\r\nutils.gEpoch = (epoch) => {\r\n    return utils.mapInto(soliditySha3(\"Ruby\", epoch));\r\n};\r\n\r\nutils.u = (epoch, x) => {\r\n    return utils.gEpoch(epoch).mul(x);\r\n};\r\n\r\nutils.hash = (encoded) => { // ags are serialized\r\n    return new BN(soliditySha3(encoded).slice(2), 16).toRed(bn128.q);\r\n};\r\n\r\nmodule.exports = utils;\r\n","\r\nconst ClientBase = require('./client_base.js');\r\nconst aes = require('./utils/aes.js');\r\nconst BN = require('bn.js');\r\nconst BigNumber = require('bignumber.js');\r\n\r\nclass ClientRubyERC20 extends ClientBase {\r\n    \r\n    constructor(web3, ruby, home, erc20Token) {\r\n        super(web3, ruby, home);\r\n        if (erc20Token === undefined)\r\n            throw \"4th arg should be an ERC20 contract.\";\r\n        \r\n        console.log(\"ERC20 contract: \" + erc20Token.options.address);\r\n\r\n        this.erc20Token = erc20Token;\r\n    }\r\n\r\n    async mint (value, approveGasLimit, mintGasLimit) {\r\n        var that = this;\r\n        that.checkRegistered();\r\n        that.checkValue();\r\n        var account = that.account;\r\n        console.log(\"Initiating mint: value of \" + value + \" units (\" + value * that.unit + \" tokens)\");\r\n        var nativeValue = that.web3.utils.toBN(new BigNumber(value * that.unit)).toString();\r\n        if (approveGasLimit === undefined)\r\n            approveGasLimit = 60000;\r\n\r\n        var allowance =  await that.erc20Token.methods.allowance(that.home, that.ruby.options.address).call();\r\n        if(allowance < nativeValue) {\r\n          await that.erc20Token.methods.approve(that.ruby.options.address, nativeValue)\r\n          .send({from: that.home, gas: approveGasLimit});\r\n        }\r\n        console.log(\"ERC20 tokens approved. Start mint...\");\r\n\r\n        let encGuess = '0x' + aes.encrypt(new BN(account.available()).toString(16), account.aesKey);\r\n\r\n        if (mintGasLimit === undefined)\r\n            mintGasLimit = 400000;\r\n        let transaction = that.ruby.methods.mint(account.publicKeySerialized(), value, encGuess)\r\n            .send({from: that.home, gas: mintGasLimit})\r\n            .on('transactionHash', (hash) => {\r\n                console.log(\"Mint submitted (txHash = \\\"\" + hash + \"\\\").\");\r\n            })\r\n            .on('receipt', async (receipt) => {\r\n                account._state = await account.update();\r\n                account._state.pending += parseInt(value);\r\n                console.log(\"Mint of \" + value + \" was successful (uses gas: \" + receipt[\"gasUsed\"] + \")\");  \r\n                console.log(\"Account state: available = \", that.account.available(), \", pending = \", that.account.pending(), \", lastRollOver = \", that.account.lastRollOver());\r\n            })\r\n            .on('error', (error) => {\r\n                console.log(\"Mint failed: \" + error);\r\n            });\r\n        return transaction;\r\n    }\r\n}\r\n\r\nmodule.exports = ClientRubyERC20;\r\n","const ABICoder = require('web3-eth-abi');\r\n\r\nconst { GeneratorParams } = require('./algebra.js');\r\nconst bn128 = require('../utils/bn128.js');\r\nconst utils = require('../utils/utils.js');\r\n\r\nclass InnerProductProof {\r\n    constructor() {\r\n        this.serialize = () => {\r\n            var result = \"0x\";\r\n            this.L.forEach((l) => {\r\n                result += bn128.representation(l).slice(2);\r\n            });\r\n            this.R.forEach((r) => {\r\n                result += bn128.representation(r).slice(2);\r\n            });\r\n            result += bn128.bytes(this.a).slice(2);\r\n            result += bn128.bytes(this.b).slice(2);\r\n            return result;\r\n        };\r\n    }\r\n}\r\n\r\nclass InnerProductProver {\r\n    constructor() {\r\n        var generateProof = (base, P, as, bs, ls, rs, previousChallenge) => {\r\n            var n = as.length();\r\n            if (n == 1) {\r\n                var proof = new InnerProductProof();\r\n                proof.L = ls;\r\n                proof.R = rs;\r\n                proof.a = as.getVector()[0];\r\n                proof.b = bs.getVector()[0];\r\n                return proof;\r\n            }\r\n            var nPrime = n / 2;\r\n            var asLeft = as.slice(0, nPrime);\r\n            var asRight = as.slice(nPrime);\r\n            var bsLeft = bs.slice(0, nPrime);\r\n            var bsRight = bs.slice(nPrime);\r\n            var gLeft = base.getGs().slice(0, nPrime);\r\n            var gRight = base.getGs().slice(nPrime);\r\n            var hLeft = base.getHs().slice(0, nPrime);\r\n            var hRight = base.getHs().slice(nPrime);\r\n\r\n            var cL = asLeft.innerProduct(bsRight);\r\n            var cR = asRight.innerProduct(bsLeft);\r\n\r\n            var u = base.getH();\r\n            var L = gRight.commit(asLeft).add(hLeft.commit(bsRight)).add(u.mul(cL));\r\n            var R = gLeft.commit(asRight).add(hRight.commit(bsLeft)).add(u.mul(cR));\r\n            ls.push(L);\r\n            rs.push(R);\r\n\r\n            var x = utils.hash(ABICoder.encodeParameters(['bytes32', 'bytes32[2]', 'bytes32[2]'], [bn128.bytes(previousChallenge), bn128.serialize(L), bn128.serialize(R)]));\r\n            var xInv = x.redInvm();\r\n            var gPrime = gLeft.times(xInv).add(gRight.times(x));\r\n            var hPrime = hLeft.times(x).add(hRight.times(xInv));\r\n            var aPrime = asLeft.times(x).add(asRight.times(xInv));\r\n            var bPrime = bsLeft.times(xInv).add(bsRight.times(x));\r\n\r\n            var PPrime = L.mul(x.redMul(x)).add(R.mul(xInv.redMul(xInv))).add(P);\r\n            var basePrime = new GeneratorParams(u, gPrime, hPrime);\r\n\r\n            return generateProof(basePrime, PPrime, aPrime, bPrime, ls, rs, x);\r\n        };\r\n\r\n        this.generateProof = (statement, witness, salt) => {\r\n            return generateProof(statement['primeBase'], statement['P'], witness['l'], witness['r'], [], [], salt);\r\n        };\r\n    }\r\n}\r\n\r\nmodule.exports = InnerProductProver;\r\n"],"sourceRoot":""}